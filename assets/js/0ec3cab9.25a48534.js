"use strict";(self.webpackChunkdocusaurus=self.webpackChunkdocusaurus||[]).push([[91],{5680:(a,e,s)=>{s.d(e,{xA:()=>g,yg:()=>c});var n=s(6540);function t(a,e,s){return e in a?Object.defineProperty(a,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):a[e]=s,a}function m(a,e){var s=Object.keys(a);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(a);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(a,e).enumerable}))),s.push.apply(s,n)}return s}function p(a){for(var e=1;e<arguments.length;e++){var s=null!=arguments[e]?arguments[e]:{};e%2?m(Object(s),!0).forEach((function(e){t(a,e,s[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(s)):m(Object(s)).forEach((function(e){Object.defineProperty(a,e,Object.getOwnPropertyDescriptor(s,e))}))}return a}function r(a,e){if(null==a)return{};var s,n,t=function(a,e){if(null==a)return{};var s,n,t={},m=Object.keys(a);for(n=0;n<m.length;n++)s=m[n],e.indexOf(s)>=0||(t[s]=a[s]);return t}(a,e);if(Object.getOwnPropertySymbols){var m=Object.getOwnPropertySymbols(a);for(n=0;n<m.length;n++)s=m[n],e.indexOf(s)>=0||Object.prototype.propertyIsEnumerable.call(a,s)&&(t[s]=a[s])}return t}var i=n.createContext({}),l=function(a){var e=n.useContext(i),s=e;return a&&(s="function"==typeof a?a(e):p(p({},e),a)),s},g=function(a){var e=l(a.components);return n.createElement(i.Provider,{value:e},a.children)},N="mdxType",y={inlineCode:"code",wrapper:function(a){var e=a.children;return n.createElement(n.Fragment,{},e)}},o=n.forwardRef((function(a,e){var s=a.components,t=a.mdxType,m=a.originalType,i=a.parentName,g=r(a,["components","mdxType","originalType","parentName"]),N=l(s),o=t,c=N["".concat(i,".").concat(o)]||N[o]||y[o]||m;return s?n.createElement(c,p(p({ref:e},g),{},{components:s})):n.createElement(c,p({ref:e},g))}));function c(a,e){var s=arguments,t=e&&e.mdxType;if("string"==typeof a||t){var m=s.length,p=new Array(m);p[0]=o;var r={};for(var i in e)hasOwnProperty.call(e,i)&&(r[i]=e[i]);r.originalType=a,r[N]="string"==typeof a?a:t,p[1]=r;for(var l=2;l<m;l++)p[l]=s[l];return n.createElement.apply(null,p)}return n.createElement.apply(null,s)}o.displayName="MDXCreateElement"},4681:(a,e,s)=>{s.r(e),s.d(e,{assets:()=>i,contentTitle:()=>p,default:()=>y,frontMatter:()=>m,metadata:()=>r,toc:()=>l});var n=s(8168),t=(s(6540),s(5680));s(1873);const m={},p="NTT - Number Theoretic Transform",r={unversionedId:"icicle/primitives/ntt",id:"icicle/primitives/ntt",title:"NTT - Number Theoretic Transform",description:"The Number Theoretic Transform (NTT) is a variant of the Fourier Transform used over finite fields, particularly those of integers modulo a prime number. NTT operates in a discrete domain and is used primarily in applications requiring modular arithmetic, such as cryptography and polynomial multiplication.",source:"@site/docs/icicle/primitives/ntt.md",sourceDirName:"icicle/primitives",slug:"/icicle/primitives/ntt",permalink:"/icicle/icicle/primitives/ntt",editUrl:"https://github.com/ingonyama-zk/developer-docs/tree/main/docs/icicle/primitives/ntt.md",tags:[],version:"current",lastUpdatedBy:"Jeremy Felder",lastUpdatedAt:1709188030,formattedLastUpdatedAt:"2/29/2024",frontMatter:{},sidebar:"GettingStartedSidebar",previous:{title:"Poseidon",permalink:"/icicle/icicle/primitives/poseidon"},next:{title:"Multi GPU with ICICLE",permalink:"/icicle/icicle/multi-gpu"}},i={},l=[{value:"Supported curves",id:"supported-curves",level:3},{value:"Examples",id:"examples",level:3},{value:"NTT API overview",id:"ntt-api-overview",level:2},{value:"NTT Config",id:"ntt-config",level:3},{value:"Fields",id:"fields",level:4},{value:"Usage",id:"usage",level:4},{value:"Ordering",id:"ordering",level:3},{value:"Modes",id:"modes",level:3},{value:"Supported algorithms",id:"supported-algorithms",level:2},{value:"Radix 2",id:"radix-2",level:3},{value:"Mixed Radix",id:"mixed-radix",level:3},{value:"Which algorithm should I choose ?",id:"which-algorithm-should-i-choose-",level:3}],g={toc:l},N="wrapper";function y(a){let{components:e,...s}=a;return(0,t.yg)(N,(0,n.A)({},g,s,{components:e,mdxType:"MDXLayout"}),(0,t.yg)("h1",{id:"ntt---number-theoretic-transform"},"NTT - Number Theoretic Transform"),(0,t.yg)("p",null,"The Number Theoretic Transform (NTT) is a variant of the Fourier Transform used over finite fields, particularly those of integers modulo a prime number. NTT operates in a discrete domain and is used primarily in applications requiring modular arithmetic, such as cryptography and polynomial multiplication."),(0,t.yg)("p",null,"NTT is defined similarly to the Discrete Fourier Transform (DFT), but instead of using complex roots of unity, it uses roots of unity within a finite field. The definition hinges on the properties of the finite field, specifically the existence of a primitive root of unity of order ",(0,t.yg)("span",{parentName:"p",className:"math math-inline"},(0,t.yg)("span",{parentName:"span",className:"katex"},(0,t.yg)("span",{parentName:"span",className:"katex-mathml"},(0,t.yg)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,t.yg)("semantics",{parentName:"math"},(0,t.yg)("mrow",{parentName:"semantics"},(0,t.yg)("mi",{parentName:"mrow"},"N")),(0,t.yg)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"N")))),(0,t.yg)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,t.yg)("span",{parentName:"span",className:"base"},(0,t.yg)("span",{parentName:"span",className:"strut",style:{height:"0.6833em"}}),(0,t.yg)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.10903em"}},"N")))))," (where ",(0,t.yg)("span",{parentName:"p",className:"math math-inline"},(0,t.yg)("span",{parentName:"span",className:"katex"},(0,t.yg)("span",{parentName:"span",className:"katex-mathml"},(0,t.yg)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,t.yg)("semantics",{parentName:"math"},(0,t.yg)("mrow",{parentName:"semantics"},(0,t.yg)("mi",{parentName:"mrow"},"N")),(0,t.yg)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"N")))),(0,t.yg)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,t.yg)("span",{parentName:"span",className:"base"},(0,t.yg)("span",{parentName:"span",className:"strut",style:{height:"0.6833em"}}),(0,t.yg)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.10903em"}},"N")))))," is typically a power of 2), and the modulo operation is performed with respect to a specific prime number that supports these roots."),(0,t.yg)("p",null,"Formally, given a sequence of integers ",(0,t.yg)("span",{parentName:"p",className:"math math-inline"},(0,t.yg)("span",{parentName:"span",className:"katex"},(0,t.yg)("span",{parentName:"span",className:"katex-mathml"},(0,t.yg)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,t.yg)("semantics",{parentName:"math"},(0,t.yg)("mrow",{parentName:"semantics"},(0,t.yg)("msub",{parentName:"mrow"},(0,t.yg)("mi",{parentName:"msub"},"a"),(0,t.yg)("mn",{parentName:"msub"},"0")),(0,t.yg)("mo",{parentName:"mrow",separator:"true"},","),(0,t.yg)("msub",{parentName:"mrow"},(0,t.yg)("mi",{parentName:"msub"},"a"),(0,t.yg)("mn",{parentName:"msub"},"1")),(0,t.yg)("mo",{parentName:"mrow",separator:"true"},","),(0,t.yg)("mi",{parentName:"mrow",mathvariant:"normal"},"."),(0,t.yg)("mi",{parentName:"mrow",mathvariant:"normal"},"."),(0,t.yg)("mi",{parentName:"mrow",mathvariant:"normal"},"."),(0,t.yg)("mo",{parentName:"mrow",separator:"true"},","),(0,t.yg)("msub",{parentName:"mrow"},(0,t.yg)("mi",{parentName:"msub"},"a"),(0,t.yg)("mrow",{parentName:"msub"},(0,t.yg)("mi",{parentName:"mrow"},"N"),(0,t.yg)("mo",{parentName:"mrow"},"\u2212"),(0,t.yg)("mn",{parentName:"mrow"},"1")))),(0,t.yg)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"a_0, a_1, ..., a_{N-1}")))),(0,t.yg)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,t.yg)("span",{parentName:"span",className:"base"},(0,t.yg)("span",{parentName:"span",className:"strut",style:{height:"0.6389em",verticalAlign:"-0.2083em"}}),(0,t.yg)("span",{parentName:"span",className:"mord"},(0,t.yg)("span",{parentName:"span",className:"mord mathnormal"},"a"),(0,t.yg)("span",{parentName:"span",className:"msupsub"},(0,t.yg)("span",{parentName:"span",className:"vlist-t vlist-t2"},(0,t.yg)("span",{parentName:"span",className:"vlist-r"},(0,t.yg)("span",{parentName:"span",className:"vlist",style:{height:"0.3011em"}},(0,t.yg)("span",{parentName:"span",style:{top:"-2.55em",marginLeft:"0em",marginRight:"0.05em"}},(0,t.yg)("span",{parentName:"span",className:"pstrut",style:{height:"2.7em"}}),(0,t.yg)("span",{parentName:"span",className:"sizing reset-size6 size3 mtight"},(0,t.yg)("span",{parentName:"span",className:"mord mtight"},"0")))),(0,t.yg)("span",{parentName:"span",className:"vlist-s"},"\u200b")),(0,t.yg)("span",{parentName:"span",className:"vlist-r"},(0,t.yg)("span",{parentName:"span",className:"vlist",style:{height:"0.15em"}},(0,t.yg)("span",{parentName:"span"})))))),(0,t.yg)("span",{parentName:"span",className:"mpunct"},","),(0,t.yg)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.1667em"}}),(0,t.yg)("span",{parentName:"span",className:"mord"},(0,t.yg)("span",{parentName:"span",className:"mord mathnormal"},"a"),(0,t.yg)("span",{parentName:"span",className:"msupsub"},(0,t.yg)("span",{parentName:"span",className:"vlist-t vlist-t2"},(0,t.yg)("span",{parentName:"span",className:"vlist-r"},(0,t.yg)("span",{parentName:"span",className:"vlist",style:{height:"0.3011em"}},(0,t.yg)("span",{parentName:"span",style:{top:"-2.55em",marginLeft:"0em",marginRight:"0.05em"}},(0,t.yg)("span",{parentName:"span",className:"pstrut",style:{height:"2.7em"}}),(0,t.yg)("span",{parentName:"span",className:"sizing reset-size6 size3 mtight"},(0,t.yg)("span",{parentName:"span",className:"mord mtight"},"1")))),(0,t.yg)("span",{parentName:"span",className:"vlist-s"},"\u200b")),(0,t.yg)("span",{parentName:"span",className:"vlist-r"},(0,t.yg)("span",{parentName:"span",className:"vlist",style:{height:"0.15em"}},(0,t.yg)("span",{parentName:"span"})))))),(0,t.yg)("span",{parentName:"span",className:"mpunct"},","),(0,t.yg)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.1667em"}}),(0,t.yg)("span",{parentName:"span",className:"mord"},"..."),(0,t.yg)("span",{parentName:"span",className:"mpunct"},","),(0,t.yg)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.1667em"}}),(0,t.yg)("span",{parentName:"span",className:"mord"},(0,t.yg)("span",{parentName:"span",className:"mord mathnormal"},"a"),(0,t.yg)("span",{parentName:"span",className:"msupsub"},(0,t.yg)("span",{parentName:"span",className:"vlist-t vlist-t2"},(0,t.yg)("span",{parentName:"span",className:"vlist-r"},(0,t.yg)("span",{parentName:"span",className:"vlist",style:{height:"0.3283em"}},(0,t.yg)("span",{parentName:"span",style:{top:"-2.55em",marginLeft:"0em",marginRight:"0.05em"}},(0,t.yg)("span",{parentName:"span",className:"pstrut",style:{height:"2.7em"}}),(0,t.yg)("span",{parentName:"span",className:"sizing reset-size6 size3 mtight"},(0,t.yg)("span",{parentName:"span",className:"mord mtight"},(0,t.yg)("span",{parentName:"span",className:"mord mathnormal mtight",style:{marginRight:"0.10903em"}},"N"),(0,t.yg)("span",{parentName:"span",className:"mbin mtight"},"\u2212"),(0,t.yg)("span",{parentName:"span",className:"mord mtight"},"1"))))),(0,t.yg)("span",{parentName:"span",className:"vlist-s"},"\u200b")),(0,t.yg)("span",{parentName:"span",className:"vlist-r"},(0,t.yg)("span",{parentName:"span",className:"vlist",style:{height:"0.2083em"}},(0,t.yg)("span",{parentName:"span"})))))))))),", the NTT of this sequence is another sequence of integers ",(0,t.yg)("span",{parentName:"p",className:"math math-inline"},(0,t.yg)("span",{parentName:"span",className:"katex"},(0,t.yg)("span",{parentName:"span",className:"katex-mathml"},(0,t.yg)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,t.yg)("semantics",{parentName:"math"},(0,t.yg)("mrow",{parentName:"semantics"},(0,t.yg)("msub",{parentName:"mrow"},(0,t.yg)("mi",{parentName:"msub"},"A"),(0,t.yg)("mn",{parentName:"msub"},"0")),(0,t.yg)("mo",{parentName:"mrow",separator:"true"},","),(0,t.yg)("msub",{parentName:"mrow"},(0,t.yg)("mi",{parentName:"msub"},"A"),(0,t.yg)("mn",{parentName:"msub"},"1")),(0,t.yg)("mo",{parentName:"mrow",separator:"true"},","),(0,t.yg)("mi",{parentName:"mrow",mathvariant:"normal"},"."),(0,t.yg)("mi",{parentName:"mrow",mathvariant:"normal"},"."),(0,t.yg)("mi",{parentName:"mrow",mathvariant:"normal"},"."),(0,t.yg)("mo",{parentName:"mrow",separator:"true"},","),(0,t.yg)("msub",{parentName:"mrow"},(0,t.yg)("mi",{parentName:"msub"},"A"),(0,t.yg)("mrow",{parentName:"msub"},(0,t.yg)("mi",{parentName:"mrow"},"N"),(0,t.yg)("mo",{parentName:"mrow"},"\u2212"),(0,t.yg)("mn",{parentName:"mrow"},"1")))),(0,t.yg)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"A_0, A_1, ..., A_{N-1}")))),(0,t.yg)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,t.yg)("span",{parentName:"span",className:"base"},(0,t.yg)("span",{parentName:"span",className:"strut",style:{height:"0.8917em",verticalAlign:"-0.2083em"}}),(0,t.yg)("span",{parentName:"span",className:"mord"},(0,t.yg)("span",{parentName:"span",className:"mord mathnormal"},"A"),(0,t.yg)("span",{parentName:"span",className:"msupsub"},(0,t.yg)("span",{parentName:"span",className:"vlist-t vlist-t2"},(0,t.yg)("span",{parentName:"span",className:"vlist-r"},(0,t.yg)("span",{parentName:"span",className:"vlist",style:{height:"0.3011em"}},(0,t.yg)("span",{parentName:"span",style:{top:"-2.55em",marginLeft:"0em",marginRight:"0.05em"}},(0,t.yg)("span",{parentName:"span",className:"pstrut",style:{height:"2.7em"}}),(0,t.yg)("span",{parentName:"span",className:"sizing reset-size6 size3 mtight"},(0,t.yg)("span",{parentName:"span",className:"mord mtight"},"0")))),(0,t.yg)("span",{parentName:"span",className:"vlist-s"},"\u200b")),(0,t.yg)("span",{parentName:"span",className:"vlist-r"},(0,t.yg)("span",{parentName:"span",className:"vlist",style:{height:"0.15em"}},(0,t.yg)("span",{parentName:"span"})))))),(0,t.yg)("span",{parentName:"span",className:"mpunct"},","),(0,t.yg)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.1667em"}}),(0,t.yg)("span",{parentName:"span",className:"mord"},(0,t.yg)("span",{parentName:"span",className:"mord mathnormal"},"A"),(0,t.yg)("span",{parentName:"span",className:"msupsub"},(0,t.yg)("span",{parentName:"span",className:"vlist-t vlist-t2"},(0,t.yg)("span",{parentName:"span",className:"vlist-r"},(0,t.yg)("span",{parentName:"span",className:"vlist",style:{height:"0.3011em"}},(0,t.yg)("span",{parentName:"span",style:{top:"-2.55em",marginLeft:"0em",marginRight:"0.05em"}},(0,t.yg)("span",{parentName:"span",className:"pstrut",style:{height:"2.7em"}}),(0,t.yg)("span",{parentName:"span",className:"sizing reset-size6 size3 mtight"},(0,t.yg)("span",{parentName:"span",className:"mord mtight"},"1")))),(0,t.yg)("span",{parentName:"span",className:"vlist-s"},"\u200b")),(0,t.yg)("span",{parentName:"span",className:"vlist-r"},(0,t.yg)("span",{parentName:"span",className:"vlist",style:{height:"0.15em"}},(0,t.yg)("span",{parentName:"span"})))))),(0,t.yg)("span",{parentName:"span",className:"mpunct"},","),(0,t.yg)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.1667em"}}),(0,t.yg)("span",{parentName:"span",className:"mord"},"..."),(0,t.yg)("span",{parentName:"span",className:"mpunct"},","),(0,t.yg)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.1667em"}}),(0,t.yg)("span",{parentName:"span",className:"mord"},(0,t.yg)("span",{parentName:"span",className:"mord mathnormal"},"A"),(0,t.yg)("span",{parentName:"span",className:"msupsub"},(0,t.yg)("span",{parentName:"span",className:"vlist-t vlist-t2"},(0,t.yg)("span",{parentName:"span",className:"vlist-r"},(0,t.yg)("span",{parentName:"span",className:"vlist",style:{height:"0.3283em"}},(0,t.yg)("span",{parentName:"span",style:{top:"-2.55em",marginLeft:"0em",marginRight:"0.05em"}},(0,t.yg)("span",{parentName:"span",className:"pstrut",style:{height:"2.7em"}}),(0,t.yg)("span",{parentName:"span",className:"sizing reset-size6 size3 mtight"},(0,t.yg)("span",{parentName:"span",className:"mord mtight"},(0,t.yg)("span",{parentName:"span",className:"mord mathnormal mtight",style:{marginRight:"0.10903em"}},"N"),(0,t.yg)("span",{parentName:"span",className:"mbin mtight"},"\u2212"),(0,t.yg)("span",{parentName:"span",className:"mord mtight"},"1"))))),(0,t.yg)("span",{parentName:"span",className:"vlist-s"},"\u200b")),(0,t.yg)("span",{parentName:"span",className:"vlist-r"},(0,t.yg)("span",{parentName:"span",className:"vlist",style:{height:"0.2083em"}},(0,t.yg)("span",{parentName:"span"})))))))))),", computed as follows:"),(0,t.yg)("div",{className:"math math-display"},(0,t.yg)("span",{parentName:"div",className:"katex-display"},(0,t.yg)("span",{parentName:"span",className:"katex"},(0,t.yg)("span",{parentName:"span",className:"katex-mathml"},(0,t.yg)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},(0,t.yg)("semantics",{parentName:"math"},(0,t.yg)("mrow",{parentName:"semantics"},(0,t.yg)("msub",{parentName:"mrow"},(0,t.yg)("mi",{parentName:"msub"},"A"),(0,t.yg)("mi",{parentName:"msub"},"k")),(0,t.yg)("mo",{parentName:"mrow"},"="),(0,t.yg)("munderover",{parentName:"mrow"},(0,t.yg)("mo",{parentName:"munderover"},"\u2211"),(0,t.yg)("mrow",{parentName:"munderover"},(0,t.yg)("mi",{parentName:"mrow"},"n"),(0,t.yg)("mo",{parentName:"mrow"},"="),(0,t.yg)("mn",{parentName:"mrow"},"0")),(0,t.yg)("mrow",{parentName:"munderover"},(0,t.yg)("mi",{parentName:"mrow"},"N"),(0,t.yg)("mo",{parentName:"mrow"},"\u2212"),(0,t.yg)("mn",{parentName:"mrow"},"1"))),(0,t.yg)("msub",{parentName:"mrow"},(0,t.yg)("mi",{parentName:"msub"},"a"),(0,t.yg)("mi",{parentName:"msub"},"n")),(0,t.yg)("mo",{parentName:"mrow"},"\u22c5"),(0,t.yg)("msup",{parentName:"mrow"},(0,t.yg)("mi",{parentName:"msup"},"\u03c9"),(0,t.yg)("mrow",{parentName:"msup"},(0,t.yg)("mi",{parentName:"mrow"},"n"),(0,t.yg)("mi",{parentName:"mrow"},"k"))),(0,t.yg)("mspace",{parentName:"mrow"}),(0,t.yg)("mspace",{parentName:"mrow",width:"1em"}),(0,t.yg)("mrow",{parentName:"mrow"},(0,t.yg)("mi",{parentName:"mrow",mathvariant:"normal"},"m"),(0,t.yg)("mi",{parentName:"mrow",mathvariant:"normal"},"o"),(0,t.yg)("mi",{parentName:"mrow",mathvariant:"normal"},"d")),(0,t.yg)("mtext",{parentName:"mrow"},"\u2009"),(0,t.yg)("mtext",{parentName:"mrow"},"\u2009"),(0,t.yg)("mi",{parentName:"mrow"},"p")),(0,t.yg)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"A_k = \\sum_{n=0}^{N-1} a_n \\cdot \\omega^{nk} \\mod p")))),(0,t.yg)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,t.yg)("span",{parentName:"span",className:"base"},(0,t.yg)("span",{parentName:"span",className:"strut",style:{height:"0.8333em",verticalAlign:"-0.15em"}}),(0,t.yg)("span",{parentName:"span",className:"mord"},(0,t.yg)("span",{parentName:"span",className:"mord mathnormal"},"A"),(0,t.yg)("span",{parentName:"span",className:"msupsub"},(0,t.yg)("span",{parentName:"span",className:"vlist-t vlist-t2"},(0,t.yg)("span",{parentName:"span",className:"vlist-r"},(0,t.yg)("span",{parentName:"span",className:"vlist",style:{height:"0.3361em"}},(0,t.yg)("span",{parentName:"span",style:{top:"-2.55em",marginLeft:"0em",marginRight:"0.05em"}},(0,t.yg)("span",{parentName:"span",className:"pstrut",style:{height:"2.7em"}}),(0,t.yg)("span",{parentName:"span",className:"sizing reset-size6 size3 mtight"},(0,t.yg)("span",{parentName:"span",className:"mord mathnormal mtight",style:{marginRight:"0.03148em"}},"k")))),(0,t.yg)("span",{parentName:"span",className:"vlist-s"},"\u200b")),(0,t.yg)("span",{parentName:"span",className:"vlist-r"},(0,t.yg)("span",{parentName:"span",className:"vlist",style:{height:"0.15em"}},(0,t.yg)("span",{parentName:"span"})))))),(0,t.yg)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2778em"}}),(0,t.yg)("span",{parentName:"span",className:"mrel"},"="),(0,t.yg)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2778em"}})),(0,t.yg)("span",{parentName:"span",className:"base"},(0,t.yg)("span",{parentName:"span",className:"strut",style:{height:"3.0954em",verticalAlign:"-1.2671em"}}),(0,t.yg)("span",{parentName:"span",className:"mop op-limits"},(0,t.yg)("span",{parentName:"span",className:"vlist-t vlist-t2"},(0,t.yg)("span",{parentName:"span",className:"vlist-r"},(0,t.yg)("span",{parentName:"span",className:"vlist",style:{height:"1.8283em"}},(0,t.yg)("span",{parentName:"span",style:{top:"-1.8829em",marginLeft:"0em"}},(0,t.yg)("span",{parentName:"span",className:"pstrut",style:{height:"3.05em"}}),(0,t.yg)("span",{parentName:"span",className:"sizing reset-size6 size3 mtight"},(0,t.yg)("span",{parentName:"span",className:"mord mtight"},(0,t.yg)("span",{parentName:"span",className:"mord mathnormal mtight"},"n"),(0,t.yg)("span",{parentName:"span",className:"mrel mtight"},"="),(0,t.yg)("span",{parentName:"span",className:"mord mtight"},"0")))),(0,t.yg)("span",{parentName:"span",style:{top:"-3.05em"}},(0,t.yg)("span",{parentName:"span",className:"pstrut",style:{height:"3.05em"}}),(0,t.yg)("span",{parentName:"span"},(0,t.yg)("span",{parentName:"span",className:"mop op-symbol large-op"},"\u2211"))),(0,t.yg)("span",{parentName:"span",style:{top:"-4.3em",marginLeft:"0em"}},(0,t.yg)("span",{parentName:"span",className:"pstrut",style:{height:"3.05em"}}),(0,t.yg)("span",{parentName:"span",className:"sizing reset-size6 size3 mtight"},(0,t.yg)("span",{parentName:"span",className:"mord mtight"},(0,t.yg)("span",{parentName:"span",className:"mord mathnormal mtight",style:{marginRight:"0.10903em"}},"N"),(0,t.yg)("span",{parentName:"span",className:"mbin mtight"},"\u2212"),(0,t.yg)("span",{parentName:"span",className:"mord mtight"},"1"))))),(0,t.yg)("span",{parentName:"span",className:"vlist-s"},"\u200b")),(0,t.yg)("span",{parentName:"span",className:"vlist-r"},(0,t.yg)("span",{parentName:"span",className:"vlist",style:{height:"1.2671em"}},(0,t.yg)("span",{parentName:"span"}))))),(0,t.yg)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.1667em"}}),(0,t.yg)("span",{parentName:"span",className:"mord"},(0,t.yg)("span",{parentName:"span",className:"mord mathnormal"},"a"),(0,t.yg)("span",{parentName:"span",className:"msupsub"},(0,t.yg)("span",{parentName:"span",className:"vlist-t vlist-t2"},(0,t.yg)("span",{parentName:"span",className:"vlist-r"},(0,t.yg)("span",{parentName:"span",className:"vlist",style:{height:"0.1514em"}},(0,t.yg)("span",{parentName:"span",style:{top:"-2.55em",marginLeft:"0em",marginRight:"0.05em"}},(0,t.yg)("span",{parentName:"span",className:"pstrut",style:{height:"2.7em"}}),(0,t.yg)("span",{parentName:"span",className:"sizing reset-size6 size3 mtight"},(0,t.yg)("span",{parentName:"span",className:"mord mathnormal mtight"},"n")))),(0,t.yg)("span",{parentName:"span",className:"vlist-s"},"\u200b")),(0,t.yg)("span",{parentName:"span",className:"vlist-r"},(0,t.yg)("span",{parentName:"span",className:"vlist",style:{height:"0.15em"}},(0,t.yg)("span",{parentName:"span"})))))),(0,t.yg)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2222em"}}),(0,t.yg)("span",{parentName:"span",className:"mbin"},"\u22c5"),(0,t.yg)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2222em"}})),(0,t.yg)("span",{parentName:"span",className:"base"},(0,t.yg)("span",{parentName:"span",className:"strut",style:{height:"0.8991em"}}),(0,t.yg)("span",{parentName:"span",className:"mord"},(0,t.yg)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.03588em"}},"\u03c9"),(0,t.yg)("span",{parentName:"span",className:"msupsub"},(0,t.yg)("span",{parentName:"span",className:"vlist-t"},(0,t.yg)("span",{parentName:"span",className:"vlist-r"},(0,t.yg)("span",{parentName:"span",className:"vlist",style:{height:"0.8991em"}},(0,t.yg)("span",{parentName:"span",style:{top:"-3.113em",marginRight:"0.05em"}},(0,t.yg)("span",{parentName:"span",className:"pstrut",style:{height:"2.7em"}}),(0,t.yg)("span",{parentName:"span",className:"sizing reset-size6 size3 mtight"},(0,t.yg)("span",{parentName:"span",className:"mord mtight"},(0,t.yg)("span",{parentName:"span",className:"mord mathnormal mtight",style:{marginRight:"0.03148em"}},"nk"))))))))),(0,t.yg)("span",{parentName:"span",className:"mspace allowbreak"}),(0,t.yg)("span",{parentName:"span",className:"mspace",style:{marginRight:"1em"}})),(0,t.yg)("span",{parentName:"span",className:"base"},(0,t.yg)("span",{parentName:"span",className:"strut",style:{height:"0.8889em",verticalAlign:"-0.1944em"}}),(0,t.yg)("span",{parentName:"span",className:"mord"},(0,t.yg)("span",{parentName:"span",className:"mord"},(0,t.yg)("span",{parentName:"span",className:"mord mathrm"},"mod"))),(0,t.yg)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.1667em"}}),(0,t.yg)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.1667em"}}),(0,t.yg)("span",{parentName:"span",className:"mord mathnormal"},"p")))))),(0,t.yg)("p",null,"where:"),(0,t.yg)("ul",null,(0,t.yg)("li",{parentName:"ul"},(0,t.yg)("span",{parentName:"li",className:"math math-inline"},(0,t.yg)("span",{parentName:"span",className:"katex"},(0,t.yg)("span",{parentName:"span",className:"katex-mathml"},(0,t.yg)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,t.yg)("semantics",{parentName:"math"},(0,t.yg)("mrow",{parentName:"semantics"},(0,t.yg)("mi",{parentName:"mrow"},"N")),(0,t.yg)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"N")))),(0,t.yg)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,t.yg)("span",{parentName:"span",className:"base"},(0,t.yg)("span",{parentName:"span",className:"strut",style:{height:"0.6833em"}}),(0,t.yg)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.10903em"}},"N")))))," is the size of the input sequence and is a power of 2,"),(0,t.yg)("li",{parentName:"ul"},(0,t.yg)("span",{parentName:"li",className:"math math-inline"},(0,t.yg)("span",{parentName:"span",className:"katex"},(0,t.yg)("span",{parentName:"span",className:"katex-mathml"},(0,t.yg)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,t.yg)("semantics",{parentName:"math"},(0,t.yg)("mrow",{parentName:"semantics"},(0,t.yg)("mi",{parentName:"mrow"},"p")),(0,t.yg)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"p")))),(0,t.yg)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,t.yg)("span",{parentName:"span",className:"base"},(0,t.yg)("span",{parentName:"span",className:"strut",style:{height:"0.625em",verticalAlign:"-0.1944em"}}),(0,t.yg)("span",{parentName:"span",className:"mord mathnormal"},"p")))))," is a prime number such that ",(0,t.yg)("span",{parentName:"li",className:"math math-inline"},(0,t.yg)("span",{parentName:"span",className:"katex"},(0,t.yg)("span",{parentName:"span",className:"katex-mathml"},(0,t.yg)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,t.yg)("semantics",{parentName:"math"},(0,t.yg)("mrow",{parentName:"semantics"},(0,t.yg)("mi",{parentName:"mrow"},"p"),(0,t.yg)("mo",{parentName:"mrow"},"="),(0,t.yg)("mi",{parentName:"mrow"},"k"),(0,t.yg)("mi",{parentName:"mrow"},"N"),(0,t.yg)("mo",{parentName:"mrow"},"+"),(0,t.yg)("mn",{parentName:"mrow"},"1")),(0,t.yg)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"p = kN + 1")))),(0,t.yg)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,t.yg)("span",{parentName:"span",className:"base"},(0,t.yg)("span",{parentName:"span",className:"strut",style:{height:"0.625em",verticalAlign:"-0.1944em"}}),(0,t.yg)("span",{parentName:"span",className:"mord mathnormal"},"p"),(0,t.yg)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2778em"}}),(0,t.yg)("span",{parentName:"span",className:"mrel"},"="),(0,t.yg)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2778em"}})),(0,t.yg)("span",{parentName:"span",className:"base"},(0,t.yg)("span",{parentName:"span",className:"strut",style:{height:"0.7778em",verticalAlign:"-0.0833em"}}),(0,t.yg)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.03148em"}},"k"),(0,t.yg)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.10903em"}},"N"),(0,t.yg)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2222em"}}),(0,t.yg)("span",{parentName:"span",className:"mbin"},"+"),(0,t.yg)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2222em"}})),(0,t.yg)("span",{parentName:"span",className:"base"},(0,t.yg)("span",{parentName:"span",className:"strut",style:{height:"0.6444em"}}),(0,t.yg)("span",{parentName:"span",className:"mord"},"1")))))," for some integer ",(0,t.yg)("span",{parentName:"li",className:"math math-inline"},(0,t.yg)("span",{parentName:"span",className:"katex"},(0,t.yg)("span",{parentName:"span",className:"katex-mathml"},(0,t.yg)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,t.yg)("semantics",{parentName:"math"},(0,t.yg)("mrow",{parentName:"semantics"},(0,t.yg)("mi",{parentName:"mrow"},"k")),(0,t.yg)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"k")))),(0,t.yg)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,t.yg)("span",{parentName:"span",className:"base"},(0,t.yg)("span",{parentName:"span",className:"strut",style:{height:"0.6944em"}}),(0,t.yg)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.03148em"}},"k"))))),", ensuring that ",(0,t.yg)("span",{parentName:"li",className:"math math-inline"},(0,t.yg)("span",{parentName:"span",className:"katex"},(0,t.yg)("span",{parentName:"span",className:"katex-mathml"},(0,t.yg)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,t.yg)("semantics",{parentName:"math"},(0,t.yg)("mrow",{parentName:"semantics"},(0,t.yg)("mi",{parentName:"mrow"},"p")),(0,t.yg)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"p")))),(0,t.yg)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,t.yg)("span",{parentName:"span",className:"base"},(0,t.yg)("span",{parentName:"span",className:"strut",style:{height:"0.625em",verticalAlign:"-0.1944em"}}),(0,t.yg)("span",{parentName:"span",className:"mord mathnormal"},"p")))))," supports the existence of ",(0,t.yg)("span",{parentName:"li",className:"math math-inline"},(0,t.yg)("span",{parentName:"span",className:"katex"},(0,t.yg)("span",{parentName:"span",className:"katex-mathml"},(0,t.yg)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,t.yg)("semantics",{parentName:"math"},(0,t.yg)("mrow",{parentName:"semantics"},(0,t.yg)("mi",{parentName:"mrow"},"N")),(0,t.yg)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"N")))),(0,t.yg)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,t.yg)("span",{parentName:"span",className:"base"},(0,t.yg)("span",{parentName:"span",className:"strut",style:{height:"0.6833em"}}),(0,t.yg)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.10903em"}},"N"))))),"th roots of unity,"),(0,t.yg)("li",{parentName:"ul"},(0,t.yg)("span",{parentName:"li",className:"math math-inline"},(0,t.yg)("span",{parentName:"span",className:"katex"},(0,t.yg)("span",{parentName:"span",className:"katex-mathml"},(0,t.yg)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,t.yg)("semantics",{parentName:"math"},(0,t.yg)("mrow",{parentName:"semantics"},(0,t.yg)("mi",{parentName:"mrow"},"\u03c9")),(0,t.yg)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"\\omega")))),(0,t.yg)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,t.yg)("span",{parentName:"span",className:"base"},(0,t.yg)("span",{parentName:"span",className:"strut",style:{height:"0.4306em"}}),(0,t.yg)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.03588em"}},"\u03c9")))))," is a primitive ",(0,t.yg)("span",{parentName:"li",className:"math math-inline"},(0,t.yg)("span",{parentName:"span",className:"katex"},(0,t.yg)("span",{parentName:"span",className:"katex-mathml"},(0,t.yg)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,t.yg)("semantics",{parentName:"math"},(0,t.yg)("mrow",{parentName:"semantics"},(0,t.yg)("mi",{parentName:"mrow"},"N")),(0,t.yg)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"N")))),(0,t.yg)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,t.yg)("span",{parentName:"span",className:"base"},(0,t.yg)("span",{parentName:"span",className:"strut",style:{height:"0.6833em"}}),(0,t.yg)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.10903em"}},"N"))))),"th root of unity modulo ",(0,t.yg)("span",{parentName:"li",className:"math math-inline"},(0,t.yg)("span",{parentName:"span",className:"katex"},(0,t.yg)("span",{parentName:"span",className:"katex-mathml"},(0,t.yg)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,t.yg)("semantics",{parentName:"math"},(0,t.yg)("mrow",{parentName:"semantics"},(0,t.yg)("mi",{parentName:"mrow"},"p")),(0,t.yg)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"p")))),(0,t.yg)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,t.yg)("span",{parentName:"span",className:"base"},(0,t.yg)("span",{parentName:"span",className:"strut",style:{height:"0.625em",verticalAlign:"-0.1944em"}}),(0,t.yg)("span",{parentName:"span",className:"mord mathnormal"},"p"))))),", meaning ",(0,t.yg)("span",{parentName:"li",className:"math math-inline"},(0,t.yg)("span",{parentName:"span",className:"katex"},(0,t.yg)("span",{parentName:"span",className:"katex-mathml"},(0,t.yg)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,t.yg)("semantics",{parentName:"math"},(0,t.yg)("mrow",{parentName:"semantics"},(0,t.yg)("msup",{parentName:"mrow"},(0,t.yg)("mi",{parentName:"msup"},"\u03c9"),(0,t.yg)("mi",{parentName:"msup"},"N")),(0,t.yg)("mo",{parentName:"mrow"},"\u2261"),(0,t.yg)("mn",{parentName:"mrow"},"1"),(0,t.yg)("mspace",{parentName:"mrow"}),(0,t.yg)("mspace",{parentName:"mrow",width:"0.6667em"}),(0,t.yg)("mrow",{parentName:"mrow"},(0,t.yg)("mi",{parentName:"mrow",mathvariant:"normal"},"m"),(0,t.yg)("mi",{parentName:"mrow",mathvariant:"normal"},"o"),(0,t.yg)("mi",{parentName:"mrow",mathvariant:"normal"},"d")),(0,t.yg)("mtext",{parentName:"mrow"},"\u2009"),(0,t.yg)("mtext",{parentName:"mrow"},"\u2009"),(0,t.yg)("mi",{parentName:"mrow"},"p")),(0,t.yg)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"\\omega^N \\equiv 1 \\mod p")))),(0,t.yg)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,t.yg)("span",{parentName:"span",className:"base"},(0,t.yg)("span",{parentName:"span",className:"strut",style:{height:"0.8413em"}}),(0,t.yg)("span",{parentName:"span",className:"mord"},(0,t.yg)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.03588em"}},"\u03c9"),(0,t.yg)("span",{parentName:"span",className:"msupsub"},(0,t.yg)("span",{parentName:"span",className:"vlist-t"},(0,t.yg)("span",{parentName:"span",className:"vlist-r"},(0,t.yg)("span",{parentName:"span",className:"vlist",style:{height:"0.8413em"}},(0,t.yg)("span",{parentName:"span",style:{top:"-3.063em",marginRight:"0.05em"}},(0,t.yg)("span",{parentName:"span",className:"pstrut",style:{height:"2.7em"}}),(0,t.yg)("span",{parentName:"span",className:"sizing reset-size6 size3 mtight"},(0,t.yg)("span",{parentName:"span",className:"mord mathnormal mtight",style:{marginRight:"0.10903em"}},"N")))))))),(0,t.yg)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2778em"}}),(0,t.yg)("span",{parentName:"span",className:"mrel"},"\u2261"),(0,t.yg)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2778em"}})),(0,t.yg)("span",{parentName:"span",className:"base"},(0,t.yg)("span",{parentName:"span",className:"strut",style:{height:"0.6444em"}}),(0,t.yg)("span",{parentName:"span",className:"mord"},"1"),(0,t.yg)("span",{parentName:"span",className:"mspace allowbreak"}),(0,t.yg)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.6667em"}})),(0,t.yg)("span",{parentName:"span",className:"base"},(0,t.yg)("span",{parentName:"span",className:"strut",style:{height:"0.8889em",verticalAlign:"-0.1944em"}}),(0,t.yg)("span",{parentName:"span",className:"mord"},(0,t.yg)("span",{parentName:"span",className:"mord"},(0,t.yg)("span",{parentName:"span",className:"mord mathrm"},"mod"))),(0,t.yg)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.1667em"}}),(0,t.yg)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.1667em"}}),(0,t.yg)("span",{parentName:"span",className:"mord mathnormal"},"p")))))," and no smaller positive power of ",(0,t.yg)("span",{parentName:"li",className:"math math-inline"},(0,t.yg)("span",{parentName:"span",className:"katex"},(0,t.yg)("span",{parentName:"span",className:"katex-mathml"},(0,t.yg)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,t.yg)("semantics",{parentName:"math"},(0,t.yg)("mrow",{parentName:"semantics"},(0,t.yg)("mi",{parentName:"mrow"},"\u03c9")),(0,t.yg)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"\\omega")))),(0,t.yg)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,t.yg)("span",{parentName:"span",className:"base"},(0,t.yg)("span",{parentName:"span",className:"strut",style:{height:"0.4306em"}}),(0,t.yg)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.03588em"}},"\u03c9")))))," is congruent to 1 modulo ",(0,t.yg)("span",{parentName:"li",className:"math math-inline"},(0,t.yg)("span",{parentName:"span",className:"katex"},(0,t.yg)("span",{parentName:"span",className:"katex-mathml"},(0,t.yg)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,t.yg)("semantics",{parentName:"math"},(0,t.yg)("mrow",{parentName:"semantics"},(0,t.yg)("mi",{parentName:"mrow"},"p")),(0,t.yg)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"p")))),(0,t.yg)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,t.yg)("span",{parentName:"span",className:"base"},(0,t.yg)("span",{parentName:"span",className:"strut",style:{height:"0.625em",verticalAlign:"-0.1944em"}}),(0,t.yg)("span",{parentName:"span",className:"mord mathnormal"},"p"))))),","),(0,t.yg)("li",{parentName:"ul"},(0,t.yg)("span",{parentName:"li",className:"math math-inline"},(0,t.yg)("span",{parentName:"span",className:"katex"},(0,t.yg)("span",{parentName:"span",className:"katex-mathml"},(0,t.yg)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,t.yg)("semantics",{parentName:"math"},(0,t.yg)("mrow",{parentName:"semantics"},(0,t.yg)("mi",{parentName:"mrow"},"k")),(0,t.yg)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"k")))),(0,t.yg)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,t.yg)("span",{parentName:"span",className:"base"},(0,t.yg)("span",{parentName:"span",className:"strut",style:{height:"0.6944em"}}),(0,t.yg)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.03148em"}},"k")))))," ranges from 0 to ",(0,t.yg)("span",{parentName:"li",className:"math math-inline"},(0,t.yg)("span",{parentName:"span",className:"katex"},(0,t.yg)("span",{parentName:"span",className:"katex-mathml"},(0,t.yg)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,t.yg)("semantics",{parentName:"math"},(0,t.yg)("mrow",{parentName:"semantics"},(0,t.yg)("mi",{parentName:"mrow"},"N"),(0,t.yg)("mo",{parentName:"mrow"},"\u2212"),(0,t.yg)("mn",{parentName:"mrow"},"1")),(0,t.yg)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"N-1")))),(0,t.yg)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,t.yg)("span",{parentName:"span",className:"base"},(0,t.yg)("span",{parentName:"span",className:"strut",style:{height:"0.7667em",verticalAlign:"-0.0833em"}}),(0,t.yg)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.10903em"}},"N"),(0,t.yg)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2222em"}}),(0,t.yg)("span",{parentName:"span",className:"mbin"},"\u2212"),(0,t.yg)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2222em"}})),(0,t.yg)("span",{parentName:"span",className:"base"},(0,t.yg)("span",{parentName:"span",className:"strut",style:{height:"0.6444em"}}),(0,t.yg)("span",{parentName:"span",className:"mord"},"1"))))),", and it indexes the output sequence.")),(0,t.yg)("p",null,"The NTT is particularly useful because it enables efficient polynomial multiplication under modulo arithmetic, crucial for algorithms in cryptographic protocols, and other areas requiring fast modular arithmetic operations. "),(0,t.yg)("p",null,"There exists also INTT which is the inverse operation of NTT. INTT can take as input an output sequence of integers from an NTT and reconstruct the original sequence."),(0,t.yg)("h1",{id:"using-ntt"},"Using NTT"),(0,t.yg)("h3",{id:"supported-curves"},"Supported curves"),(0,t.yg)("p",null,"NTT supports the following curves:"),(0,t.yg)("p",null,(0,t.yg)("inlineCode",{parentName:"p"},"bls12-377"),", ",(0,t.yg)("inlineCode",{parentName:"p"},"bls12-381"),", ",(0,t.yg)("inlineCode",{parentName:"p"},"bn-254"),", ",(0,t.yg)("inlineCode",{parentName:"p"},"bw6-761")),(0,t.yg)("h3",{id:"examples"},"Examples"),(0,t.yg)("ul",null,(0,t.yg)("li",{parentName:"ul"},(0,t.yg)("p",{parentName:"li"},(0,t.yg)("a",{parentName:"p",href:"https://github.com/ingonyama-zk/icicle/blob/d84ffd2679a4cb8f8d1ac2ad2897bc0b95f4eeeb/examples/rust/ntt/src/main.rs#L1"},"Rust API examples"))),(0,t.yg)("li",{parentName:"ul"},(0,t.yg)("p",{parentName:"li"},(0,t.yg)("a",{parentName:"p",href:"https://github.com/ingonyama-zk/icicle/blob/d84ffd2679a4cb8f8d1ac2ad2897bc0b95f4eeeb/examples/c%2B%2B/ntt/example.cu#L1"},"C++ API examples")))),(0,t.yg)("h2",{id:"ntt-api-overview"},"NTT API overview"),(0,t.yg)("pre",null,(0,t.yg)("code",{parentName:"pre",className:"language-rust"},"pub fn ntt<F>(\n    input: &HostOrDeviceSlice<F>,\n    dir: NTTDir,\n    cfg: &NTTConfig<F>,\n    output: &mut HostOrDeviceSlice<F>,\n) -> IcicleResult<()>\n")),(0,t.yg)("p",null,(0,t.yg)("inlineCode",{parentName:"p"},"ntt:ntt")," expects:"),(0,t.yg)("p",null,(0,t.yg)("inlineCode",{parentName:"p"},"input")," - buffer to read the inputs of the NTT from. ",(0,t.yg)("br",null),"\n",(0,t.yg)("inlineCode",{parentName:"p"},"dir")," - whether to compute forward or inverse NTT. ",(0,t.yg)("br",null),"\n",(0,t.yg)("inlineCode",{parentName:"p"},"cfg")," - config used to specify extra arguments of the NTT. ",(0,t.yg)("br",null),"\n",(0,t.yg)("inlineCode",{parentName:"p"},"output")," - buffer to write the NTT outputs into. Must be of the same  size as input."),(0,t.yg)("p",null,"The ",(0,t.yg)("inlineCode",{parentName:"p"},"input")," and ",(0,t.yg)("inlineCode",{parentName:"p"},"output")," buffers can be on device or on host. Being on host means that they will be transferred to device during runtime."),(0,t.yg)("h3",{id:"ntt-config"},"NTT Config"),(0,t.yg)("pre",null,(0,t.yg)("code",{parentName:"pre",className:"language-rust"},"pub struct NTTConfig<'a, S> {\n    pub ctx: DeviceContext<'a>,\n    pub coset_gen: S,\n    pub batch_size: i32,\n    pub ordering: Ordering,\n    are_inputs_on_device: bool,    \n    are_outputs_on_device: bool,\n    pub is_async: bool,\n    pub ntt_algorithm: NttAlgorithm,\n}\n")),(0,t.yg)("p",null,"The ",(0,t.yg)("inlineCode",{parentName:"p"},"NTTConfig")," struct is a configuration object used to specify parameters for an NTT instance."),(0,t.yg)("h4",{id:"fields"},"Fields"),(0,t.yg)("ul",null,(0,t.yg)("li",{parentName:"ul"},(0,t.yg)("p",{parentName:"li"},(0,t.yg)("strong",{parentName:"p"},(0,t.yg)("inlineCode",{parentName:"strong"},"ctx: DeviceContext<'a>")),": Specifies the device context, including the device ID and the stream ID.")),(0,t.yg)("li",{parentName:"ul"},(0,t.yg)("p",{parentName:"li"},(0,t.yg)("strong",{parentName:"p"},(0,t.yg)("inlineCode",{parentName:"strong"},"coset_gen: S")),": Defines the coset generator used for coset (i)NTTs. By default, this is set to ",(0,t.yg)("inlineCode",{parentName:"p"},"S::one()"),", indicating that no coset is being used.")),(0,t.yg)("li",{parentName:"ul"},(0,t.yg)("p",{parentName:"li"},(0,t.yg)("strong",{parentName:"p"},(0,t.yg)("inlineCode",{parentName:"strong"},"batch_size: i32")),": Determines the number of NTTs to compute in a single batch. The default value is 1, meaning that operations are performed on individual inputs without batching. Batch processing can significantly improve performance by leveraging parallelism in GPU computations.")),(0,t.yg)("li",{parentName:"ul"},(0,t.yg)("p",{parentName:"li"},(0,t.yg)("strong",{parentName:"p"},(0,t.yg)("inlineCode",{parentName:"strong"},"ordering: Ordering")),": Controls the ordering of inputs and outputs for the NTT operation. This field can be used to specify decimation strategies (in time or in frequency) and the type of butterfly algorithm (Cooley-Tukey or Gentleman-Sande). The ordering is crucial for compatibility with various algorithmic approaches and can impact the efficiency of the NTT.")),(0,t.yg)("li",{parentName:"ul"},(0,t.yg)("p",{parentName:"li"},(0,t.yg)("strong",{parentName:"p"},(0,t.yg)("inlineCode",{parentName:"strong"},"are_inputs_on_device: bool")),": Indicates whether the input data has been preloaded on the device memory. If ",(0,t.yg)("inlineCode",{parentName:"p"},"false")," inputs will be copied from host to device.")),(0,t.yg)("li",{parentName:"ul"},(0,t.yg)("p",{parentName:"li"},(0,t.yg)("strong",{parentName:"p"},(0,t.yg)("inlineCode",{parentName:"strong"},"are_outputs_on_device: bool")),": Indicates whether the output data is preloaded in device memory. If ",(0,t.yg)("inlineCode",{parentName:"p"},"false")," outputs will be copied from host to device. If the inputs and outputs are the same pointer NTT will be computed in place.")),(0,t.yg)("li",{parentName:"ul"},(0,t.yg)("p",{parentName:"li"},(0,t.yg)("strong",{parentName:"p"},(0,t.yg)("inlineCode",{parentName:"strong"},"is_async: bool")),": Specifies whether the NTT operation should be performed asynchronously. When set to ",(0,t.yg)("inlineCode",{parentName:"p"},"true"),", the NTT function will not block the CPU, allowing other operations to proceed concurrently. Asynchronous execution requires careful synchronization to ensure data integrity and correctness.")),(0,t.yg)("li",{parentName:"ul"},(0,t.yg)("p",{parentName:"li"},(0,t.yg)("strong",{parentName:"p"},(0,t.yg)("inlineCode",{parentName:"strong"},"ntt_algorithm: NttAlgorithm")),": Can be one of ",(0,t.yg)("inlineCode",{parentName:"p"},"Auto"),", ",(0,t.yg)("inlineCode",{parentName:"p"},"Radix2"),", ",(0,t.yg)("inlineCode",{parentName:"p"},"MixedRadix"),".\n",(0,t.yg)("inlineCode",{parentName:"p"},"Auto")," will select ",(0,t.yg)("inlineCode",{parentName:"p"},"Radix 2")," or ",(0,t.yg)("inlineCode",{parentName:"p"},"Mixed Radix")," algorithm based on heuristics.\n",(0,t.yg)("inlineCode",{parentName:"p"},"Radix2")," and ",(0,t.yg)("inlineCode",{parentName:"p"},"MixedRadix")," will force the use of an algorithm regardless of the input size or other considerations. You should use one of these options when you know for sure that you want to "))),(0,t.yg)("h4",{id:"usage"},"Usage"),(0,t.yg)("p",null,"Example initialization with default settings:"),(0,t.yg)("pre",null,(0,t.yg)("code",{parentName:"pre",className:"language-rust"},"let default_config = NTTConfig::default();\n")),(0,t.yg)("p",null,"Customizing the configuration:"),(0,t.yg)("pre",null,(0,t.yg)("code",{parentName:"pre",className:"language-rust"},"let custom_config = NTTConfig {\n    ctx: custom_device_context,\n    coset_gen: my_coset_generator,\n    batch_size: 10,\n    ordering: Ordering::kRN,\n    are_inputs_on_device: true,\n    are_outputs_on_device: true,\n    is_async: false,\n    ntt_algorithm: NttAlgorithm::MixedRadix,\n};\n")),(0,t.yg)("h3",{id:"ordering"},"Ordering"),(0,t.yg)("p",null,"The ",(0,t.yg)("inlineCode",{parentName:"p"},"Ordering")," enum defines how inputs and outputs are arranged for the NTT operation, offering flexibility in handling data according to different algorithmic needs or compatibility requirements. It primarily affects the sequencing of data points for the transform, which can influence both performance and the compatibility with certain algorithmic approaches. The available ordering options are:"),(0,t.yg)("ul",null,(0,t.yg)("li",{parentName:"ul"},(0,t.yg)("p",{parentName:"li"},(0,t.yg)("strong",{parentName:"p"},(0,t.yg)("inlineCode",{parentName:"strong"},"kNN")," (Natural-Natural):")," Both inputs and outputs are in their natural order. This is the simplest form of ordering, where data is processed in the sequence it is given, without any rearrangement.")),(0,t.yg)("li",{parentName:"ul"},(0,t.yg)("p",{parentName:"li"},(0,t.yg)("strong",{parentName:"p"},(0,t.yg)("inlineCode",{parentName:"strong"},"kNR")," (Natural-Reversed):")," Inputs are in natural order, while outputs are in bit-reversed order. This ordering is typically used in algorithms that benefit from having the output in a bit-reversed pattern.")),(0,t.yg)("li",{parentName:"ul"},(0,t.yg)("p",{parentName:"li"},(0,t.yg)("strong",{parentName:"p"},(0,t.yg)("inlineCode",{parentName:"strong"},"kRN")," (Reversed-Natural):")," Inputs are in bit-reversed order, and outputs are in natural order. This is often used with the Cooley-Tukey FFT algorithm.")),(0,t.yg)("li",{parentName:"ul"},(0,t.yg)("p",{parentName:"li"},(0,t.yg)("strong",{parentName:"p"},(0,t.yg)("inlineCode",{parentName:"strong"},"kRR")," (Reversed-Reversed):")," Both inputs and outputs are in bit-reversed order.")),(0,t.yg)("li",{parentName:"ul"},(0,t.yg)("p",{parentName:"li"},(0,t.yg)("strong",{parentName:"p"},(0,t.yg)("inlineCode",{parentName:"strong"},"kNM")," (Natural-Mixed):")," Inputs are provided in their natural order, while outputs are arranged in a digit-reversed (mixed) order. This ordering is good for mixed radix NTT operations, where the mixed or digit-reversed ordering of outputs is a generalization of the bit-reversal pattern seen in simpler, radix-2 cases.")),(0,t.yg)("li",{parentName:"ul"},(0,t.yg)("p",{parentName:"li"},(0,t.yg)("strong",{parentName:"p"},(0,t.yg)("inlineCode",{parentName:"strong"},"kMN")," (Mixed-Natural):")," Inputs are in a digit-reversed (mixed) order, while outputs are restored to their natural order. This ordering would primarily be used for mixed radix NTT"))),(0,t.yg)("p",null,"Choosing an algorithm is heavily dependent on your use case. For example Cooley-Tukey will often use ",(0,t.yg)("inlineCode",{parentName:"p"},"kRN")," and Gentleman-Sande often uses ",(0,t.yg)("inlineCode",{parentName:"p"},"kNR"),"."),(0,t.yg)("h3",{id:"modes"},"Modes"),(0,t.yg)("p",null,"NTT also supports two different modes ",(0,t.yg)("inlineCode",{parentName:"p"},"Batch NTT")," and ",(0,t.yg)("inlineCode",{parentName:"p"},"Single NTT")),(0,t.yg)("p",null,"Batch NTT allows you to run many NTTs with a single API call, Single MSM will launch a single MSM computation."),(0,t.yg)("p",null,"You may toggle between single and batch NTT by simply configure ",(0,t.yg)("inlineCode",{parentName:"p"},"batch_size")," to be larger then 1 in your ",(0,t.yg)("inlineCode",{parentName:"p"},"NTTConfig"),"."),(0,t.yg)("pre",null,(0,t.yg)("code",{parentName:"pre",className:"language-rust"},"let mut cfg = ntt::get_default_ntt_config::<ScalarField>();\ncfg.batch_size = 10 // your ntt using this config will run in batch mode.\n")),(0,t.yg)("p",null,(0,t.yg)("inlineCode",{parentName:"p"},"batch_size=1")," would keep our NTT in single NTT mode."),(0,t.yg)("p",null,"Deciding weather to use ",(0,t.yg)("inlineCode",{parentName:"p"},"batch NTT")," vs ",(0,t.yg)("inlineCode",{parentName:"p"},"single NTT")," is highly dependent on your application and use case."),(0,t.yg)("p",null,(0,t.yg)("strong",{parentName:"p"},"Single NTT Mode")),(0,t.yg)("ul",null,(0,t.yg)("li",{parentName:"ul"},"Choose this mode when your application requires processing individual NTT operations in isolation.")),(0,t.yg)("p",null,(0,t.yg)("strong",{parentName:"p"},"Batch NTT Mode")),(0,t.yg)("ul",null,(0,t.yg)("li",{parentName:"ul"},(0,t.yg)("p",{parentName:"li"},"Batch NTT mode can significantly reduce read/write as well as computation overhead by executing multiple NTT operations in parallel.")),(0,t.yg)("li",{parentName:"ul"},(0,t.yg)("p",{parentName:"li"},"Batch mode may also offer better utilization of computational resources (memory and compute)."))),(0,t.yg)("h2",{id:"supported-algorithms"},"Supported algorithms"),(0,t.yg)("p",null,"Our NTT implementation supports two algorithms ",(0,t.yg)("inlineCode",{parentName:"p"},"radix-2")," and ",(0,t.yg)("inlineCode",{parentName:"p"},"mixed-radix"),"."),(0,t.yg)("h3",{id:"radix-2"},"Radix 2"),(0,t.yg)("p",null,'At its core, the Radix-2 NTT algorithm divides the problem into smaller sub-problems, leveraging the properties of "divide and conquer" to reduce the overall computational complexity. The algorithm operates on sequences whose lengths are powers of two.'),(0,t.yg)("ol",null,(0,t.yg)("li",{parentName:"ol"},(0,t.yg)("p",{parentName:"li"},(0,t.yg)("strong",{parentName:"p"},"Input Preparation:"),"\nThe input is a sequence of integers ",(0,t.yg)("span",{parentName:"p",className:"math math-inline"},(0,t.yg)("span",{parentName:"span",className:"katex"},(0,t.yg)("span",{parentName:"span",className:"katex-mathml"},(0,t.yg)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,t.yg)("semantics",{parentName:"math"},(0,t.yg)("mrow",{parentName:"semantics"},(0,t.yg)("msub",{parentName:"mrow"},(0,t.yg)("mi",{parentName:"msub"},"a"),(0,t.yg)("mn",{parentName:"msub"},"0")),(0,t.yg)("mo",{parentName:"mrow",separator:"true"},","),(0,t.yg)("msub",{parentName:"mrow"},(0,t.yg)("mi",{parentName:"msub"},"a"),(0,t.yg)("mn",{parentName:"msub"},"1")),(0,t.yg)("mo",{parentName:"mrow",separator:"true"},","),(0,t.yg)("mo",{parentName:"mrow"},"\u2026"),(0,t.yg)("mo",{parentName:"mrow",separator:"true"},","),(0,t.yg)("msub",{parentName:"mrow"},(0,t.yg)("mi",{parentName:"msub"},"a"),(0,t.yg)("mrow",{parentName:"msub"},(0,t.yg)("mi",{parentName:"mrow"},"N"),(0,t.yg)("mo",{parentName:"mrow"},"\u2212"),(0,t.yg)("mn",{parentName:"mrow"},"1"))),(0,t.yg)("mo",{parentName:"mrow",separator:"true"},","),(0,t.yg)("mtext",{parentName:"mrow"},"\xa0where\xa0"),(0,t.yg)("mi",{parentName:"mrow"},"N")),(0,t.yg)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"a_0, a_1, \\ldots, a_{N-1}, \\text{ where } N")))),(0,t.yg)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,t.yg)("span",{parentName:"span",className:"base"},(0,t.yg)("span",{parentName:"span",className:"strut",style:{height:"0.9028em",verticalAlign:"-0.2083em"}}),(0,t.yg)("span",{parentName:"span",className:"mord"},(0,t.yg)("span",{parentName:"span",className:"mord mathnormal"},"a"),(0,t.yg)("span",{parentName:"span",className:"msupsub"},(0,t.yg)("span",{parentName:"span",className:"vlist-t vlist-t2"},(0,t.yg)("span",{parentName:"span",className:"vlist-r"},(0,t.yg)("span",{parentName:"span",className:"vlist",style:{height:"0.3011em"}},(0,t.yg)("span",{parentName:"span",style:{top:"-2.55em",marginLeft:"0em",marginRight:"0.05em"}},(0,t.yg)("span",{parentName:"span",className:"pstrut",style:{height:"2.7em"}}),(0,t.yg)("span",{parentName:"span",className:"sizing reset-size6 size3 mtight"},(0,t.yg)("span",{parentName:"span",className:"mord mtight"},"0")))),(0,t.yg)("span",{parentName:"span",className:"vlist-s"},"\u200b")),(0,t.yg)("span",{parentName:"span",className:"vlist-r"},(0,t.yg)("span",{parentName:"span",className:"vlist",style:{height:"0.15em"}},(0,t.yg)("span",{parentName:"span"})))))),(0,t.yg)("span",{parentName:"span",className:"mpunct"},","),(0,t.yg)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.1667em"}}),(0,t.yg)("span",{parentName:"span",className:"mord"},(0,t.yg)("span",{parentName:"span",className:"mord mathnormal"},"a"),(0,t.yg)("span",{parentName:"span",className:"msupsub"},(0,t.yg)("span",{parentName:"span",className:"vlist-t vlist-t2"},(0,t.yg)("span",{parentName:"span",className:"vlist-r"},(0,t.yg)("span",{parentName:"span",className:"vlist",style:{height:"0.3011em"}},(0,t.yg)("span",{parentName:"span",style:{top:"-2.55em",marginLeft:"0em",marginRight:"0.05em"}},(0,t.yg)("span",{parentName:"span",className:"pstrut",style:{height:"2.7em"}}),(0,t.yg)("span",{parentName:"span",className:"sizing reset-size6 size3 mtight"},(0,t.yg)("span",{parentName:"span",className:"mord mtight"},"1")))),(0,t.yg)("span",{parentName:"span",className:"vlist-s"},"\u200b")),(0,t.yg)("span",{parentName:"span",className:"vlist-r"},(0,t.yg)("span",{parentName:"span",className:"vlist",style:{height:"0.15em"}},(0,t.yg)("span",{parentName:"span"})))))),(0,t.yg)("span",{parentName:"span",className:"mpunct"},","),(0,t.yg)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.1667em"}}),(0,t.yg)("span",{parentName:"span",className:"minner"},"\u2026"),(0,t.yg)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.1667em"}}),(0,t.yg)("span",{parentName:"span",className:"mpunct"},","),(0,t.yg)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.1667em"}}),(0,t.yg)("span",{parentName:"span",className:"mord"},(0,t.yg)("span",{parentName:"span",className:"mord mathnormal"},"a"),(0,t.yg)("span",{parentName:"span",className:"msupsub"},(0,t.yg)("span",{parentName:"span",className:"vlist-t vlist-t2"},(0,t.yg)("span",{parentName:"span",className:"vlist-r"},(0,t.yg)("span",{parentName:"span",className:"vlist",style:{height:"0.3283em"}},(0,t.yg)("span",{parentName:"span",style:{top:"-2.55em",marginLeft:"0em",marginRight:"0.05em"}},(0,t.yg)("span",{parentName:"span",className:"pstrut",style:{height:"2.7em"}}),(0,t.yg)("span",{parentName:"span",className:"sizing reset-size6 size3 mtight"},(0,t.yg)("span",{parentName:"span",className:"mord mtight"},(0,t.yg)("span",{parentName:"span",className:"mord mathnormal mtight",style:{marginRight:"0.10903em"}},"N"),(0,t.yg)("span",{parentName:"span",className:"mbin mtight"},"\u2212"),(0,t.yg)("span",{parentName:"span",className:"mord mtight"},"1"))))),(0,t.yg)("span",{parentName:"span",className:"vlist-s"},"\u200b")),(0,t.yg)("span",{parentName:"span",className:"vlist-r"},(0,t.yg)("span",{parentName:"span",className:"vlist",style:{height:"0.2083em"}},(0,t.yg)("span",{parentName:"span"})))))),(0,t.yg)("span",{parentName:"span",className:"mpunct"},","),(0,t.yg)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.1667em"}}),(0,t.yg)("span",{parentName:"span",className:"mord text"},(0,t.yg)("span",{parentName:"span",className:"mord"},"\xa0where\xa0")),(0,t.yg)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.10903em"}},"N")))))," is a power of two.")),(0,t.yg)("li",{parentName:"ol"},(0,t.yg)("p",{parentName:"li"},(0,t.yg)("strong",{parentName:"p"},"Recursive Decomposition:"),"\nThe algorithm recursively divides the input sequence into smaller sequences. At each step, it separates the sequence into even-indexed and odd-indexed elements, forming two subsequences that are then processed independently.")),(0,t.yg)("li",{parentName:"ol"},(0,t.yg)("p",{parentName:"li"},(0,t.yg)("strong",{parentName:"p"},"Butterfly Operations:"),'\nThe core computational element of the Radix-2 NTT is the "butterfly" operation, which combines pairs of elements from the sequences obtained in the decomposition step. '),(0,t.yg)("p",{parentName:"li"},'Each butterfly operation involves multiplication by a "twiddle factor," which is a root of unity in the finite field, and addition or subtraction of the results, all performed modulo the prime modulus.'),(0,t.yg)("div",{parentName:"li",className:"math math-display"},(0,t.yg)("span",{parentName:"div",className:"katex-display"},(0,t.yg)("span",{parentName:"span",className:"katex"},(0,t.yg)("span",{parentName:"span",className:"katex-mathml"},(0,t.yg)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},(0,t.yg)("semantics",{parentName:"math"},(0,t.yg)("mrow",{parentName:"semantics"},(0,t.yg)("msub",{parentName:"mrow"},(0,t.yg)("mi",{parentName:"msub"},"X"),(0,t.yg)("mi",{parentName:"msub"},"k")),(0,t.yg)("mo",{parentName:"mrow"},"="),(0,t.yg)("mo",{parentName:"mrow",stretchy:"false"},"("),(0,t.yg)("msub",{parentName:"mrow"},(0,t.yg)("mi",{parentName:"msub"},"A"),(0,t.yg)("mi",{parentName:"msub"},"k")),(0,t.yg)("mo",{parentName:"mrow"},"+"),(0,t.yg)("msub",{parentName:"mrow"},(0,t.yg)("mi",{parentName:"msub"},"B"),(0,t.yg)("mi",{parentName:"msub"},"k")),(0,t.yg)("mo",{parentName:"mrow"},"\u22c5"),(0,t.yg)("msup",{parentName:"mrow"},(0,t.yg)("mi",{parentName:"msup"},"W"),(0,t.yg)("mi",{parentName:"msup"},"k")),(0,t.yg)("mo",{parentName:"mrow",stretchy:"false"},")"),(0,t.yg)("mspace",{parentName:"mrow"}),(0,t.yg)("mspace",{parentName:"mrow",width:"1em"}),(0,t.yg)("mrow",{parentName:"mrow"},(0,t.yg)("mi",{parentName:"mrow",mathvariant:"normal"},"m"),(0,t.yg)("mi",{parentName:"mrow",mathvariant:"normal"},"o"),(0,t.yg)("mi",{parentName:"mrow",mathvariant:"normal"},"d")),(0,t.yg)("mtext",{parentName:"mrow"},"\u2009"),(0,t.yg)("mtext",{parentName:"mrow"},"\u2009"),(0,t.yg)("mi",{parentName:"mrow"},"p")),(0,t.yg)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"X_k = (A_k + B_k \\cdot W^k) \\mod p")))),(0,t.yg)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,t.yg)("span",{parentName:"span",className:"base"},(0,t.yg)("span",{parentName:"span",className:"strut",style:{height:"0.8333em",verticalAlign:"-0.15em"}}),(0,t.yg)("span",{parentName:"span",className:"mord"},(0,t.yg)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.07847em"}},"X"),(0,t.yg)("span",{parentName:"span",className:"msupsub"},(0,t.yg)("span",{parentName:"span",className:"vlist-t vlist-t2"},(0,t.yg)("span",{parentName:"span",className:"vlist-r"},(0,t.yg)("span",{parentName:"span",className:"vlist",style:{height:"0.3361em"}},(0,t.yg)("span",{parentName:"span",style:{top:"-2.55em",marginLeft:"-0.0785em",marginRight:"0.05em"}},(0,t.yg)("span",{parentName:"span",className:"pstrut",style:{height:"2.7em"}}),(0,t.yg)("span",{parentName:"span",className:"sizing reset-size6 size3 mtight"},(0,t.yg)("span",{parentName:"span",className:"mord mathnormal mtight",style:{marginRight:"0.03148em"}},"k")))),(0,t.yg)("span",{parentName:"span",className:"vlist-s"},"\u200b")),(0,t.yg)("span",{parentName:"span",className:"vlist-r"},(0,t.yg)("span",{parentName:"span",className:"vlist",style:{height:"0.15em"}},(0,t.yg)("span",{parentName:"span"})))))),(0,t.yg)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2778em"}}),(0,t.yg)("span",{parentName:"span",className:"mrel"},"="),(0,t.yg)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2778em"}})),(0,t.yg)("span",{parentName:"span",className:"base"},(0,t.yg)("span",{parentName:"span",className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),(0,t.yg)("span",{parentName:"span",className:"mopen"},"("),(0,t.yg)("span",{parentName:"span",className:"mord"},(0,t.yg)("span",{parentName:"span",className:"mord mathnormal"},"A"),(0,t.yg)("span",{parentName:"span",className:"msupsub"},(0,t.yg)("span",{parentName:"span",className:"vlist-t vlist-t2"},(0,t.yg)("span",{parentName:"span",className:"vlist-r"},(0,t.yg)("span",{parentName:"span",className:"vlist",style:{height:"0.3361em"}},(0,t.yg)("span",{parentName:"span",style:{top:"-2.55em",marginLeft:"0em",marginRight:"0.05em"}},(0,t.yg)("span",{parentName:"span",className:"pstrut",style:{height:"2.7em"}}),(0,t.yg)("span",{parentName:"span",className:"sizing reset-size6 size3 mtight"},(0,t.yg)("span",{parentName:"span",className:"mord mathnormal mtight",style:{marginRight:"0.03148em"}},"k")))),(0,t.yg)("span",{parentName:"span",className:"vlist-s"},"\u200b")),(0,t.yg)("span",{parentName:"span",className:"vlist-r"},(0,t.yg)("span",{parentName:"span",className:"vlist",style:{height:"0.15em"}},(0,t.yg)("span",{parentName:"span"})))))),(0,t.yg)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2222em"}}),(0,t.yg)("span",{parentName:"span",className:"mbin"},"+"),(0,t.yg)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2222em"}})),(0,t.yg)("span",{parentName:"span",className:"base"},(0,t.yg)("span",{parentName:"span",className:"strut",style:{height:"0.8333em",verticalAlign:"-0.15em"}}),(0,t.yg)("span",{parentName:"span",className:"mord"},(0,t.yg)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.05017em"}},"B"),(0,t.yg)("span",{parentName:"span",className:"msupsub"},(0,t.yg)("span",{parentName:"span",className:"vlist-t vlist-t2"},(0,t.yg)("span",{parentName:"span",className:"vlist-r"},(0,t.yg)("span",{parentName:"span",className:"vlist",style:{height:"0.3361em"}},(0,t.yg)("span",{parentName:"span",style:{top:"-2.55em",marginLeft:"-0.0502em",marginRight:"0.05em"}},(0,t.yg)("span",{parentName:"span",className:"pstrut",style:{height:"2.7em"}}),(0,t.yg)("span",{parentName:"span",className:"sizing reset-size6 size3 mtight"},(0,t.yg)("span",{parentName:"span",className:"mord mathnormal mtight",style:{marginRight:"0.03148em"}},"k")))),(0,t.yg)("span",{parentName:"span",className:"vlist-s"},"\u200b")),(0,t.yg)("span",{parentName:"span",className:"vlist-r"},(0,t.yg)("span",{parentName:"span",className:"vlist",style:{height:"0.15em"}},(0,t.yg)("span",{parentName:"span"})))))),(0,t.yg)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2222em"}}),(0,t.yg)("span",{parentName:"span",className:"mbin"},"\u22c5"),(0,t.yg)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2222em"}})),(0,t.yg)("span",{parentName:"span",className:"base"},(0,t.yg)("span",{parentName:"span",className:"strut",style:{height:"1.1491em",verticalAlign:"-0.25em"}}),(0,t.yg)("span",{parentName:"span",className:"mord"},(0,t.yg)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.13889em"}},"W"),(0,t.yg)("span",{parentName:"span",className:"msupsub"},(0,t.yg)("span",{parentName:"span",className:"vlist-t"},(0,t.yg)("span",{parentName:"span",className:"vlist-r"},(0,t.yg)("span",{parentName:"span",className:"vlist",style:{height:"0.8991em"}},(0,t.yg)("span",{parentName:"span",style:{top:"-3.113em",marginRight:"0.05em"}},(0,t.yg)("span",{parentName:"span",className:"pstrut",style:{height:"2.7em"}}),(0,t.yg)("span",{parentName:"span",className:"sizing reset-size6 size3 mtight"},(0,t.yg)("span",{parentName:"span",className:"mord mathnormal mtight",style:{marginRight:"0.03148em"}},"k")))))))),(0,t.yg)("span",{parentName:"span",className:"mclose"},")"),(0,t.yg)("span",{parentName:"span",className:"mspace allowbreak"}),(0,t.yg)("span",{parentName:"span",className:"mspace",style:{marginRight:"1em"}})),(0,t.yg)("span",{parentName:"span",className:"base"},(0,t.yg)("span",{parentName:"span",className:"strut",style:{height:"0.8889em",verticalAlign:"-0.1944em"}}),(0,t.yg)("span",{parentName:"span",className:"mord"},(0,t.yg)("span",{parentName:"span",className:"mord"},(0,t.yg)("span",{parentName:"span",className:"mord mathrm"},"mod"))),(0,t.yg)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.1667em"}}),(0,t.yg)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.1667em"}}),(0,t.yg)("span",{parentName:"span",className:"mord mathnormal"},"p")))))),(0,t.yg)("p",{parentName:"li"},(0,t.yg)("span",{parentName:"p",className:"math math-inline"},(0,t.yg)("span",{parentName:"span",className:"katex"},(0,t.yg)("span",{parentName:"span",className:"katex-mathml"},(0,t.yg)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,t.yg)("semantics",{parentName:"math"},(0,t.yg)("mrow",{parentName:"semantics"},(0,t.yg)("msub",{parentName:"mrow"},(0,t.yg)("mi",{parentName:"msub"},"X"),(0,t.yg)("mi",{parentName:"msub"},"k"))),(0,t.yg)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"X_k")))),(0,t.yg)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,t.yg)("span",{parentName:"span",className:"base"},(0,t.yg)("span",{parentName:"span",className:"strut",style:{height:"0.8333em",verticalAlign:"-0.15em"}}),(0,t.yg)("span",{parentName:"span",className:"mord"},(0,t.yg)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.07847em"}},"X"),(0,t.yg)("span",{parentName:"span",className:"msupsub"},(0,t.yg)("span",{parentName:"span",className:"vlist-t vlist-t2"},(0,t.yg)("span",{parentName:"span",className:"vlist-r"},(0,t.yg)("span",{parentName:"span",className:"vlist",style:{height:"0.3361em"}},(0,t.yg)("span",{parentName:"span",style:{top:"-2.55em",marginLeft:"-0.0785em",marginRight:"0.05em"}},(0,t.yg)("span",{parentName:"span",className:"pstrut",style:{height:"2.7em"}}),(0,t.yg)("span",{parentName:"span",className:"sizing reset-size6 size3 mtight"},(0,t.yg)("span",{parentName:"span",className:"mord mathnormal mtight",style:{marginRight:"0.03148em"}},"k")))),(0,t.yg)("span",{parentName:"span",className:"vlist-s"},"\u200b")),(0,t.yg)("span",{parentName:"span",className:"vlist-r"},(0,t.yg)("span",{parentName:"span",className:"vlist",style:{height:"0.15em"}},(0,t.yg)("span",{parentName:"span"}))))))))))," - The output of the butterfly operation for the ",(0,t.yg)("span",{parentName:"p",className:"math math-inline"},(0,t.yg)("span",{parentName:"span",className:"katex"},(0,t.yg)("span",{parentName:"span",className:"katex-mathml"},(0,t.yg)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,t.yg)("semantics",{parentName:"math"},(0,t.yg)("mrow",{parentName:"semantics"},(0,t.yg)("mi",{parentName:"mrow"},"k")),(0,t.yg)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"k")))),(0,t.yg)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,t.yg)("span",{parentName:"span",className:"base"},(0,t.yg)("span",{parentName:"span",className:"strut",style:{height:"0.6944em"}}),(0,t.yg)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.03148em"}},"k"))))),"-th element"),(0,t.yg)("p",{parentName:"li"},(0,t.yg)("span",{parentName:"p",className:"math math-inline"},(0,t.yg)("span",{parentName:"span",className:"katex"},(0,t.yg)("span",{parentName:"span",className:"katex-mathml"},(0,t.yg)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,t.yg)("semantics",{parentName:"math"},(0,t.yg)("mrow",{parentName:"semantics"},(0,t.yg)("msub",{parentName:"mrow"},(0,t.yg)("mi",{parentName:"msub"},"A"),(0,t.yg)("mi",{parentName:"msub"},"k"))),(0,t.yg)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"A_k")))),(0,t.yg)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,t.yg)("span",{parentName:"span",className:"base"},(0,t.yg)("span",{parentName:"span",className:"strut",style:{height:"0.8333em",verticalAlign:"-0.15em"}}),(0,t.yg)("span",{parentName:"span",className:"mord"},(0,t.yg)("span",{parentName:"span",className:"mord mathnormal"},"A"),(0,t.yg)("span",{parentName:"span",className:"msupsub"},(0,t.yg)("span",{parentName:"span",className:"vlist-t vlist-t2"},(0,t.yg)("span",{parentName:"span",className:"vlist-r"},(0,t.yg)("span",{parentName:"span",className:"vlist",style:{height:"0.3361em"}},(0,t.yg)("span",{parentName:"span",style:{top:"-2.55em",marginLeft:"0em",marginRight:"0.05em"}},(0,t.yg)("span",{parentName:"span",className:"pstrut",style:{height:"2.7em"}}),(0,t.yg)("span",{parentName:"span",className:"sizing reset-size6 size3 mtight"},(0,t.yg)("span",{parentName:"span",className:"mord mathnormal mtight",style:{marginRight:"0.03148em"}},"k")))),(0,t.yg)("span",{parentName:"span",className:"vlist-s"},"\u200b")),(0,t.yg)("span",{parentName:"span",className:"vlist-r"},(0,t.yg)("span",{parentName:"span",className:"vlist",style:{height:"0.15em"}},(0,t.yg)("span",{parentName:"span"}))))))))))," - an element from the even-indexed subset"),(0,t.yg)("p",{parentName:"li"},(0,t.yg)("span",{parentName:"p",className:"math math-inline"},(0,t.yg)("span",{parentName:"span",className:"katex"},(0,t.yg)("span",{parentName:"span",className:"katex-mathml"},(0,t.yg)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,t.yg)("semantics",{parentName:"math"},(0,t.yg)("mrow",{parentName:"semantics"},(0,t.yg)("msub",{parentName:"mrow"},(0,t.yg)("mi",{parentName:"msub"},"B"),(0,t.yg)("mi",{parentName:"msub"},"k"))),(0,t.yg)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"B_k")))),(0,t.yg)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,t.yg)("span",{parentName:"span",className:"base"},(0,t.yg)("span",{parentName:"span",className:"strut",style:{height:"0.8333em",verticalAlign:"-0.15em"}}),(0,t.yg)("span",{parentName:"span",className:"mord"},(0,t.yg)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.05017em"}},"B"),(0,t.yg)("span",{parentName:"span",className:"msupsub"},(0,t.yg)("span",{parentName:"span",className:"vlist-t vlist-t2"},(0,t.yg)("span",{parentName:"span",className:"vlist-r"},(0,t.yg)("span",{parentName:"span",className:"vlist",style:{height:"0.3361em"}},(0,t.yg)("span",{parentName:"span",style:{top:"-2.55em",marginLeft:"-0.0502em",marginRight:"0.05em"}},(0,t.yg)("span",{parentName:"span",className:"pstrut",style:{height:"2.7em"}}),(0,t.yg)("span",{parentName:"span",className:"sizing reset-size6 size3 mtight"},(0,t.yg)("span",{parentName:"span",className:"mord mathnormal mtight",style:{marginRight:"0.03148em"}},"k")))),(0,t.yg)("span",{parentName:"span",className:"vlist-s"},"\u200b")),(0,t.yg)("span",{parentName:"span",className:"vlist-r"},(0,t.yg)("span",{parentName:"span",className:"vlist",style:{height:"0.15em"}},(0,t.yg)("span",{parentName:"span"}))))))))))," - an element from the odd-indexed subset"),(0,t.yg)("p",{parentName:"li"},(0,t.yg)("span",{parentName:"p",className:"math math-inline"},(0,t.yg)("span",{parentName:"span",className:"katex"},(0,t.yg)("span",{parentName:"span",className:"katex-mathml"},(0,t.yg)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,t.yg)("semantics",{parentName:"math"},(0,t.yg)("mrow",{parentName:"semantics"},(0,t.yg)("mi",{parentName:"mrow"},"p")),(0,t.yg)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"p")))),(0,t.yg)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,t.yg)("span",{parentName:"span",className:"base"},(0,t.yg)("span",{parentName:"span",className:"strut",style:{height:"0.625em",verticalAlign:"-0.1944em"}}),(0,t.yg)("span",{parentName:"span",className:"mord mathnormal"},"p")))))," - prime modulus"),(0,t.yg)("p",{parentName:"li"},(0,t.yg)("span",{parentName:"p",className:"math math-inline"},(0,t.yg)("span",{parentName:"span",className:"katex"},(0,t.yg)("span",{parentName:"span",className:"katex-mathml"},(0,t.yg)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,t.yg)("semantics",{parentName:"math"},(0,t.yg)("mrow",{parentName:"semantics"},(0,t.yg)("mi",{parentName:"mrow"},"k")),(0,t.yg)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"k")))),(0,t.yg)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,t.yg)("span",{parentName:"span",className:"base"},(0,t.yg)("span",{parentName:"span",className:"strut",style:{height:"0.6944em"}}),(0,t.yg)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.03148em"}},"k")))))," - The index of the current operation within the butterfly or the transform stage"))),(0,t.yg)("p",null,"   The twiddle factors are precomputed to save runtime and improve performance."),(0,t.yg)("ol",{start:4},(0,t.yg)("li",{parentName:"ol"},(0,t.yg)("strong",{parentName:"li"},"Bit-Reversal Permutation:"),"\nA final step involves rearranging the output sequence into the correct order. Due to the halving process in the decomposition steps, the elements of the transformed sequence are initially in a bit-reversed order. A bit-reversal permutation is applied to obtain the final sequence in natural order.")),(0,t.yg)("h3",{id:"mixed-radix"},"Mixed Radix"),(0,t.yg)("p",null,'The Mixed Radix NTT algorithm extends the concepts of the Radix-2 algorithm by allowing the decomposition of the input sequence based on various factors of its length. Specifically ICICLEs implementation splits the input into blocks of sizes 16,32,64 compared to radix2 which is always splitting such that we end with NTT of size 2. This approach offers enhanced flexibility and efficiency, especially for input sizes that are composite numbers, by leveraging the "divide and conquer" strategy across multiple radixes.'),(0,t.yg)("p",null,"The NTT blocks in Mixed Radix are implemented more efficiently based on winograd NTT but also optimized memory and register usage is better compared to Radix-2."),(0,t.yg)("p",null,"Mixed Radix can reduce the number of stages required to compute for large inputs."),(0,t.yg)("ol",null,(0,t.yg)("li",{parentName:"ol"},(0,t.yg)("p",{parentName:"li"},(0,t.yg)("strong",{parentName:"p"},"Input Preparation:"),"\nThe input to the Mixed Radix NTT is a sequence of integers ",(0,t.yg)("span",{parentName:"p",className:"math math-inline"},(0,t.yg)("span",{parentName:"span",className:"katex"},(0,t.yg)("span",{parentName:"span",className:"katex-mathml"},(0,t.yg)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,t.yg)("semantics",{parentName:"math"},(0,t.yg)("mrow",{parentName:"semantics"},(0,t.yg)("msub",{parentName:"mrow"},(0,t.yg)("mi",{parentName:"msub"},"a"),(0,t.yg)("mn",{parentName:"msub"},"0")),(0,t.yg)("mo",{parentName:"mrow",separator:"true"},","),(0,t.yg)("msub",{parentName:"mrow"},(0,t.yg)("mi",{parentName:"msub"},"a"),(0,t.yg)("mn",{parentName:"msub"},"1")),(0,t.yg)("mo",{parentName:"mrow",separator:"true"},","),(0,t.yg)("mo",{parentName:"mrow"},"\u2026"),(0,t.yg)("mo",{parentName:"mrow",separator:"true"},","),(0,t.yg)("msub",{parentName:"mrow"},(0,t.yg)("mi",{parentName:"msub"},"a"),(0,t.yg)("mrow",{parentName:"msub"},(0,t.yg)("mi",{parentName:"mrow"},"N"),(0,t.yg)("mo",{parentName:"mrow"},"\u2212"),(0,t.yg)("mn",{parentName:"mrow"},"1")))),(0,t.yg)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"a_0, a_1, \\ldots, a_{N-1}")))),(0,t.yg)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,t.yg)("span",{parentName:"span",className:"base"},(0,t.yg)("span",{parentName:"span",className:"strut",style:{height:"0.6389em",verticalAlign:"-0.2083em"}}),(0,t.yg)("span",{parentName:"span",className:"mord"},(0,t.yg)("span",{parentName:"span",className:"mord mathnormal"},"a"),(0,t.yg)("span",{parentName:"span",className:"msupsub"},(0,t.yg)("span",{parentName:"span",className:"vlist-t vlist-t2"},(0,t.yg)("span",{parentName:"span",className:"vlist-r"},(0,t.yg)("span",{parentName:"span",className:"vlist",style:{height:"0.3011em"}},(0,t.yg)("span",{parentName:"span",style:{top:"-2.55em",marginLeft:"0em",marginRight:"0.05em"}},(0,t.yg)("span",{parentName:"span",className:"pstrut",style:{height:"2.7em"}}),(0,t.yg)("span",{parentName:"span",className:"sizing reset-size6 size3 mtight"},(0,t.yg)("span",{parentName:"span",className:"mord mtight"},"0")))),(0,t.yg)("span",{parentName:"span",className:"vlist-s"},"\u200b")),(0,t.yg)("span",{parentName:"span",className:"vlist-r"},(0,t.yg)("span",{parentName:"span",className:"vlist",style:{height:"0.15em"}},(0,t.yg)("span",{parentName:"span"})))))),(0,t.yg)("span",{parentName:"span",className:"mpunct"},","),(0,t.yg)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.1667em"}}),(0,t.yg)("span",{parentName:"span",className:"mord"},(0,t.yg)("span",{parentName:"span",className:"mord mathnormal"},"a"),(0,t.yg)("span",{parentName:"span",className:"msupsub"},(0,t.yg)("span",{parentName:"span",className:"vlist-t vlist-t2"},(0,t.yg)("span",{parentName:"span",className:"vlist-r"},(0,t.yg)("span",{parentName:"span",className:"vlist",style:{height:"0.3011em"}},(0,t.yg)("span",{parentName:"span",style:{top:"-2.55em",marginLeft:"0em",marginRight:"0.05em"}},(0,t.yg)("span",{parentName:"span",className:"pstrut",style:{height:"2.7em"}}),(0,t.yg)("span",{parentName:"span",className:"sizing reset-size6 size3 mtight"},(0,t.yg)("span",{parentName:"span",className:"mord mtight"},"1")))),(0,t.yg)("span",{parentName:"span",className:"vlist-s"},"\u200b")),(0,t.yg)("span",{parentName:"span",className:"vlist-r"},(0,t.yg)("span",{parentName:"span",className:"vlist",style:{height:"0.15em"}},(0,t.yg)("span",{parentName:"span"})))))),(0,t.yg)("span",{parentName:"span",className:"mpunct"},","),(0,t.yg)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.1667em"}}),(0,t.yg)("span",{parentName:"span",className:"minner"},"\u2026"),(0,t.yg)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.1667em"}}),(0,t.yg)("span",{parentName:"span",className:"mpunct"},","),(0,t.yg)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.1667em"}}),(0,t.yg)("span",{parentName:"span",className:"mord"},(0,t.yg)("span",{parentName:"span",className:"mord mathnormal"},"a"),(0,t.yg)("span",{parentName:"span",className:"msupsub"},(0,t.yg)("span",{parentName:"span",className:"vlist-t vlist-t2"},(0,t.yg)("span",{parentName:"span",className:"vlist-r"},(0,t.yg)("span",{parentName:"span",className:"vlist",style:{height:"0.3283em"}},(0,t.yg)("span",{parentName:"span",style:{top:"-2.55em",marginLeft:"0em",marginRight:"0.05em"}},(0,t.yg)("span",{parentName:"span",className:"pstrut",style:{height:"2.7em"}}),(0,t.yg)("span",{parentName:"span",className:"sizing reset-size6 size3 mtight"},(0,t.yg)("span",{parentName:"span",className:"mord mtight"},(0,t.yg)("span",{parentName:"span",className:"mord mathnormal mtight",style:{marginRight:"0.10903em"}},"N"),(0,t.yg)("span",{parentName:"span",className:"mbin mtight"},"\u2212"),(0,t.yg)("span",{parentName:"span",className:"mord mtight"},"1"))))),(0,t.yg)("span",{parentName:"span",className:"vlist-s"},"\u200b")),(0,t.yg)("span",{parentName:"span",className:"vlist-r"},(0,t.yg)("span",{parentName:"span",className:"vlist",style:{height:"0.2083em"}},(0,t.yg)("span",{parentName:"span"})))))))))),", where ",(0,t.yg)("span",{parentName:"p",className:"math math-inline"},(0,t.yg)("span",{parentName:"span",className:"katex"},(0,t.yg)("span",{parentName:"span",className:"katex-mathml"},(0,t.yg)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,t.yg)("semantics",{parentName:"math"},(0,t.yg)("mrow",{parentName:"semantics"},(0,t.yg)("mi",{parentName:"mrow"},"N")),(0,t.yg)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"N")))),(0,t.yg)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,t.yg)("span",{parentName:"span",className:"base"},(0,t.yg)("span",{parentName:"span",className:"strut",style:{height:"0.6833em"}}),(0,t.yg)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.10903em"}},"N")))))," is not strictly required to be a power of two. Instead, ",(0,t.yg)("span",{parentName:"p",className:"math math-inline"},(0,t.yg)("span",{parentName:"span",className:"katex"},(0,t.yg)("span",{parentName:"span",className:"katex-mathml"},(0,t.yg)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,t.yg)("semantics",{parentName:"math"},(0,t.yg)("mrow",{parentName:"semantics"},(0,t.yg)("mi",{parentName:"mrow"},"N")),(0,t.yg)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"N")))),(0,t.yg)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,t.yg)("span",{parentName:"span",className:"base"},(0,t.yg)("span",{parentName:"span",className:"strut",style:{height:"0.6833em"}}),(0,t.yg)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.10903em"}},"N")))))," can be any composite number, ideally factorized into primes or powers of primes.")),(0,t.yg)("li",{parentName:"ol"},(0,t.yg)("p",{parentName:"li"},(0,t.yg)("strong",{parentName:"p"},"Factorization and Decomposition:"),"\nUnlike the Radix-2 algorithm, which strictly divides the computational problem into halves, the Mixed Radix NTT algorithm implements a flexible decomposition approach which isn't limited to prime factorization. "),(0,t.yg)("p",{parentName:"li"},"For example, an NTT of size 256 can be decomposed into two stages of ",(0,t.yg)("span",{parentName:"p",className:"math math-inline"},(0,t.yg)("span",{parentName:"span",className:"katex"},(0,t.yg)("span",{parentName:"span",className:"katex-mathml"},(0,t.yg)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,t.yg)("semantics",{parentName:"math"},(0,t.yg)("mrow",{parentName:"semantics"},(0,t.yg)("mn",{parentName:"mrow"},"16"),(0,t.yg)("mo",{parentName:"mrow"},"\xd7"),(0,t.yg)("msub",{parentName:"mrow"},(0,t.yg)("mtext",{parentName:"msub"},"NTT"),(0,t.yg)("mn",{parentName:"msub"},"16"))),(0,t.yg)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"16 \\times \\text{NTT}_{16}")))),(0,t.yg)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,t.yg)("span",{parentName:"span",className:"base"},(0,t.yg)("span",{parentName:"span",className:"strut",style:{height:"0.7278em",verticalAlign:"-0.0833em"}}),(0,t.yg)("span",{parentName:"span",className:"mord"},"16"),(0,t.yg)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2222em"}}),(0,t.yg)("span",{parentName:"span",className:"mbin"},"\xd7"),(0,t.yg)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2222em"}})),(0,t.yg)("span",{parentName:"span",className:"base"},(0,t.yg)("span",{parentName:"span",className:"strut",style:{height:"0.8333em",verticalAlign:"-0.15em"}}),(0,t.yg)("span",{parentName:"span",className:"mord"},(0,t.yg)("span",{parentName:"span",className:"mord text"},(0,t.yg)("span",{parentName:"span",className:"mord"},"NTT")),(0,t.yg)("span",{parentName:"span",className:"msupsub"},(0,t.yg)("span",{parentName:"span",className:"vlist-t vlist-t2"},(0,t.yg)("span",{parentName:"span",className:"vlist-r"},(0,t.yg)("span",{parentName:"span",className:"vlist",style:{height:"0.3011em"}},(0,t.yg)("span",{parentName:"span",style:{top:"-2.55em",marginRight:"0.05em"}},(0,t.yg)("span",{parentName:"span",className:"pstrut",style:{height:"2.7em"}}),(0,t.yg)("span",{parentName:"span",className:"sizing reset-size6 size3 mtight"},(0,t.yg)("span",{parentName:"span",className:"mord mtight"},(0,t.yg)("span",{parentName:"span",className:"mord mtight"},"16"))))),(0,t.yg)("span",{parentName:"span",className:"vlist-s"},"\u200b")),(0,t.yg)("span",{parentName:"span",className:"vlist-r"},(0,t.yg)("span",{parentName:"span",className:"vlist",style:{height:"0.15em"}},(0,t.yg)("span",{parentName:"span"})))))))))),", leveraging a composite factorization strategy rather than decomposing into eight stages of ",(0,t.yg)("span",{parentName:"p",className:"math math-inline"},(0,t.yg)("span",{parentName:"span",className:"katex"},(0,t.yg)("span",{parentName:"span",className:"katex-mathml"},(0,t.yg)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,t.yg)("semantics",{parentName:"math"},(0,t.yg)("mrow",{parentName:"semantics"},(0,t.yg)("msub",{parentName:"mrow"},(0,t.yg)("mtext",{parentName:"msub"},"NTT"),(0,t.yg)("mn",{parentName:"msub"},"2"))),(0,t.yg)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"\\text{NTT}_{2}")))),(0,t.yg)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,t.yg)("span",{parentName:"span",className:"base"},(0,t.yg)("span",{parentName:"span",className:"strut",style:{height:"0.8333em",verticalAlign:"-0.15em"}}),(0,t.yg)("span",{parentName:"span",className:"mord"},(0,t.yg)("span",{parentName:"span",className:"mord text"},(0,t.yg)("span",{parentName:"span",className:"mord"},"NTT")),(0,t.yg)("span",{parentName:"span",className:"msupsub"},(0,t.yg)("span",{parentName:"span",className:"vlist-t vlist-t2"},(0,t.yg)("span",{parentName:"span",className:"vlist-r"},(0,t.yg)("span",{parentName:"span",className:"vlist",style:{height:"0.3011em"}},(0,t.yg)("span",{parentName:"span",style:{top:"-2.55em",marginRight:"0.05em"}},(0,t.yg)("span",{parentName:"span",className:"pstrut",style:{height:"2.7em"}}),(0,t.yg)("span",{parentName:"span",className:"sizing reset-size6 size3 mtight"},(0,t.yg)("span",{parentName:"span",className:"mord mtight"},(0,t.yg)("span",{parentName:"span",className:"mord mtight"},"2"))))),(0,t.yg)("span",{parentName:"span",className:"vlist-s"},"\u200b")),(0,t.yg)("span",{parentName:"span",className:"vlist-r"},(0,t.yg)("span",{parentName:"span",className:"vlist",style:{height:"0.15em"}},(0,t.yg)("span",{parentName:"span"})))))))))),". This exemplifies the use of composite factors (in this case, ",(0,t.yg)("span",{parentName:"p",className:"math math-inline"},(0,t.yg)("span",{parentName:"span",className:"katex"},(0,t.yg)("span",{parentName:"span",className:"katex-mathml"},(0,t.yg)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,t.yg)("semantics",{parentName:"math"},(0,t.yg)("mrow",{parentName:"semantics"},(0,t.yg)("mn",{parentName:"mrow"},"256"),(0,t.yg)("mo",{parentName:"mrow"},"="),(0,t.yg)("mn",{parentName:"mrow"},"16"),(0,t.yg)("mo",{parentName:"mrow"},"\xd7"),(0,t.yg)("mn",{parentName:"mrow"},"16")),(0,t.yg)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"256 = 16 \\times 16")))),(0,t.yg)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,t.yg)("span",{parentName:"span",className:"base"},(0,t.yg)("span",{parentName:"span",className:"strut",style:{height:"0.6444em"}}),(0,t.yg)("span",{parentName:"span",className:"mord"},"256"),(0,t.yg)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2778em"}}),(0,t.yg)("span",{parentName:"span",className:"mrel"},"="),(0,t.yg)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2778em"}})),(0,t.yg)("span",{parentName:"span",className:"base"},(0,t.yg)("span",{parentName:"span",className:"strut",style:{height:"0.7278em",verticalAlign:"-0.0833em"}}),(0,t.yg)("span",{parentName:"span",className:"mord"},"16"),(0,t.yg)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2222em"}}),(0,t.yg)("span",{parentName:"span",className:"mbin"},"\xd7"),(0,t.yg)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2222em"}})),(0,t.yg)("span",{parentName:"span",className:"base"},(0,t.yg)("span",{parentName:"span",className:"strut",style:{height:"0.6444em"}}),(0,t.yg)("span",{parentName:"span",className:"mord"},"16"))))),") to apply smaller NTT transforms, optimizing computational efficiency by adapting the decomposition strategy to the specific structure of ",(0,t.yg)("span",{parentName:"p",className:"math math-inline"},(0,t.yg)("span",{parentName:"span",className:"katex"},(0,t.yg)("span",{parentName:"span",className:"katex-mathml"},(0,t.yg)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,t.yg)("semantics",{parentName:"math"},(0,t.yg)("mrow",{parentName:"semantics"},(0,t.yg)("mi",{parentName:"mrow"},"N")),(0,t.yg)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"N")))),(0,t.yg)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,t.yg)("span",{parentName:"span",className:"base"},(0,t.yg)("span",{parentName:"span",className:"strut",style:{height:"0.6833em"}}),(0,t.yg)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.10903em"}},"N"))))),".")),(0,t.yg)("li",{parentName:"ol"},(0,t.yg)("p",{parentName:"li"},(0,t.yg)("strong",{parentName:"p"},"Butterfly Operations with Multiple Radixes:"),"\nThe Mixed Radix algorithm utilizes butterfly operations for various radix sizes. Each sub-transform involves specific butterfly operations characterized by multiplication with twiddle factors appropriate for the radix in question."),(0,t.yg)("p",{parentName:"li"},"The generalized butterfly operation for a radix-",(0,t.yg)("span",{parentName:"p",className:"math math-inline"},(0,t.yg)("span",{parentName:"span",className:"katex"},(0,t.yg)("span",{parentName:"span",className:"katex-mathml"},(0,t.yg)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,t.yg)("semantics",{parentName:"math"},(0,t.yg)("mrow",{parentName:"semantics"},(0,t.yg)("mi",{parentName:"mrow"},"r")),(0,t.yg)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"r")))),(0,t.yg)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,t.yg)("span",{parentName:"span",className:"base"},(0,t.yg)("span",{parentName:"span",className:"strut",style:{height:"0.4306em"}}),(0,t.yg)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.02778em"}},"r")))))," element can be expressed as:"),(0,t.yg)("div",{parentName:"li",className:"math math-display"},(0,t.yg)("span",{parentName:"div",className:"katex-display"},(0,t.yg)("span",{parentName:"span",className:"katex"},(0,t.yg)("span",{parentName:"span",className:"katex-mathml"},(0,t.yg)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},(0,t.yg)("semantics",{parentName:"math"},(0,t.yg)("mrow",{parentName:"semantics"},(0,t.yg)("msub",{parentName:"mrow"},(0,t.yg)("mi",{parentName:"msub"},"X"),(0,t.yg)("mrow",{parentName:"msub"},(0,t.yg)("mi",{parentName:"mrow"},"k"),(0,t.yg)("mo",{parentName:"mrow",separator:"true"},","),(0,t.yg)("mi",{parentName:"mrow"},"r"))),(0,t.yg)("mo",{parentName:"mrow"},"="),(0,t.yg)("munderover",{parentName:"mrow"},(0,t.yg)("mo",{parentName:"munderover"},"\u2211"),(0,t.yg)("mrow",{parentName:"munderover"},(0,t.yg)("mi",{parentName:"mrow"},"j"),(0,t.yg)("mo",{parentName:"mrow"},"="),(0,t.yg)("mn",{parentName:"mrow"},"0")),(0,t.yg)("mrow",{parentName:"munderover"},(0,t.yg)("mi",{parentName:"mrow"},"r"),(0,t.yg)("mo",{parentName:"mrow"},"\u2212"),(0,t.yg)("mn",{parentName:"mrow"},"1"))),(0,t.yg)("mo",{parentName:"mrow",stretchy:"false"},"("),(0,t.yg)("msub",{parentName:"mrow"},(0,t.yg)("mi",{parentName:"msub"},"A"),(0,t.yg)("mrow",{parentName:"msub"},(0,t.yg)("mi",{parentName:"mrow"},"j"),(0,t.yg)("mo",{parentName:"mrow",separator:"true"},","),(0,t.yg)("mi",{parentName:"mrow"},"k"))),(0,t.yg)("mo",{parentName:"mrow"},"\u22c5"),(0,t.yg)("msup",{parentName:"mrow"},(0,t.yg)("mi",{parentName:"msup"},"W"),(0,t.yg)("mrow",{parentName:"msup"},(0,t.yg)("mi",{parentName:"mrow"},"j"),(0,t.yg)("mi",{parentName:"mrow"},"k"))),(0,t.yg)("mo",{parentName:"mrow",stretchy:"false"},")"),(0,t.yg)("mspace",{parentName:"mrow"}),(0,t.yg)("mspace",{parentName:"mrow",width:"1em"}),(0,t.yg)("mrow",{parentName:"mrow"},(0,t.yg)("mi",{parentName:"mrow",mathvariant:"normal"},"m"),(0,t.yg)("mi",{parentName:"mrow",mathvariant:"normal"},"o"),(0,t.yg)("mi",{parentName:"mrow",mathvariant:"normal"},"d")),(0,t.yg)("mtext",{parentName:"mrow"},"\u2009"),(0,t.yg)("mtext",{parentName:"mrow"},"\u2009"),(0,t.yg)("mi",{parentName:"mrow"},"p")),(0,t.yg)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"X_{k,r} = \\sum_{j=0}^{r-1} (A_{j,k} \\cdot W^{jk}) \\mod p")))),(0,t.yg)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,t.yg)("span",{parentName:"span",className:"base"},(0,t.yg)("span",{parentName:"span",className:"strut",style:{height:"0.9694em",verticalAlign:"-0.2861em"}}),(0,t.yg)("span",{parentName:"span",className:"mord"},(0,t.yg)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.07847em"}},"X"),(0,t.yg)("span",{parentName:"span",className:"msupsub"},(0,t.yg)("span",{parentName:"span",className:"vlist-t vlist-t2"},(0,t.yg)("span",{parentName:"span",className:"vlist-r"},(0,t.yg)("span",{parentName:"span",className:"vlist",style:{height:"0.3361em"}},(0,t.yg)("span",{parentName:"span",style:{top:"-2.55em",marginLeft:"-0.0785em",marginRight:"0.05em"}},(0,t.yg)("span",{parentName:"span",className:"pstrut",style:{height:"2.7em"}}),(0,t.yg)("span",{parentName:"span",className:"sizing reset-size6 size3 mtight"},(0,t.yg)("span",{parentName:"span",className:"mord mtight"},(0,t.yg)("span",{parentName:"span",className:"mord mathnormal mtight",style:{marginRight:"0.03148em"}},"k"),(0,t.yg)("span",{parentName:"span",className:"mpunct mtight"},","),(0,t.yg)("span",{parentName:"span",className:"mord mathnormal mtight",style:{marginRight:"0.02778em"}},"r"))))),(0,t.yg)("span",{parentName:"span",className:"vlist-s"},"\u200b")),(0,t.yg)("span",{parentName:"span",className:"vlist-r"},(0,t.yg)("span",{parentName:"span",className:"vlist",style:{height:"0.2861em"}},(0,t.yg)("span",{parentName:"span"})))))),(0,t.yg)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2778em"}}),(0,t.yg)("span",{parentName:"span",className:"mrel"},"="),(0,t.yg)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2778em"}})),(0,t.yg)("span",{parentName:"span",className:"base"},(0,t.yg)("span",{parentName:"span",className:"strut",style:{height:"3.2149em",verticalAlign:"-1.4138em"}}),(0,t.yg)("span",{parentName:"span",className:"mop op-limits"},(0,t.yg)("span",{parentName:"span",className:"vlist-t vlist-t2"},(0,t.yg)("span",{parentName:"span",className:"vlist-r"},(0,t.yg)("span",{parentName:"span",className:"vlist",style:{height:"1.8011em"}},(0,t.yg)("span",{parentName:"span",style:{top:"-1.8723em",marginLeft:"0em"}},(0,t.yg)("span",{parentName:"span",className:"pstrut",style:{height:"3.05em"}}),(0,t.yg)("span",{parentName:"span",className:"sizing reset-size6 size3 mtight"},(0,t.yg)("span",{parentName:"span",className:"mord mtight"},(0,t.yg)("span",{parentName:"span",className:"mord mathnormal mtight",style:{marginRight:"0.05724em"}},"j"),(0,t.yg)("span",{parentName:"span",className:"mrel mtight"},"="),(0,t.yg)("span",{parentName:"span",className:"mord mtight"},"0")))),(0,t.yg)("span",{parentName:"span",style:{top:"-3.05em"}},(0,t.yg)("span",{parentName:"span",className:"pstrut",style:{height:"3.05em"}}),(0,t.yg)("span",{parentName:"span"},(0,t.yg)("span",{parentName:"span",className:"mop op-symbol large-op"},"\u2211"))),(0,t.yg)("span",{parentName:"span",style:{top:"-4.3em",marginLeft:"0em"}},(0,t.yg)("span",{parentName:"span",className:"pstrut",style:{height:"3.05em"}}),(0,t.yg)("span",{parentName:"span",className:"sizing reset-size6 size3 mtight"},(0,t.yg)("span",{parentName:"span",className:"mord mtight"},(0,t.yg)("span",{parentName:"span",className:"mord mathnormal mtight",style:{marginRight:"0.02778em"}},"r"),(0,t.yg)("span",{parentName:"span",className:"mbin mtight"},"\u2212"),(0,t.yg)("span",{parentName:"span",className:"mord mtight"},"1"))))),(0,t.yg)("span",{parentName:"span",className:"vlist-s"},"\u200b")),(0,t.yg)("span",{parentName:"span",className:"vlist-r"},(0,t.yg)("span",{parentName:"span",className:"vlist",style:{height:"1.4138em"}},(0,t.yg)("span",{parentName:"span"}))))),(0,t.yg)("span",{parentName:"span",className:"mopen"},"("),(0,t.yg)("span",{parentName:"span",className:"mord"},(0,t.yg)("span",{parentName:"span",className:"mord mathnormal"},"A"),(0,t.yg)("span",{parentName:"span",className:"msupsub"},(0,t.yg)("span",{parentName:"span",className:"vlist-t vlist-t2"},(0,t.yg)("span",{parentName:"span",className:"vlist-r"},(0,t.yg)("span",{parentName:"span",className:"vlist",style:{height:"0.3361em"}},(0,t.yg)("span",{parentName:"span",style:{top:"-2.55em",marginLeft:"0em",marginRight:"0.05em"}},(0,t.yg)("span",{parentName:"span",className:"pstrut",style:{height:"2.7em"}}),(0,t.yg)("span",{parentName:"span",className:"sizing reset-size6 size3 mtight"},(0,t.yg)("span",{parentName:"span",className:"mord mtight"},(0,t.yg)("span",{parentName:"span",className:"mord mathnormal mtight",style:{marginRight:"0.05724em"}},"j"),(0,t.yg)("span",{parentName:"span",className:"mpunct mtight"},","),(0,t.yg)("span",{parentName:"span",className:"mord mathnormal mtight",style:{marginRight:"0.03148em"}},"k"))))),(0,t.yg)("span",{parentName:"span",className:"vlist-s"},"\u200b")),(0,t.yg)("span",{parentName:"span",className:"vlist-r"},(0,t.yg)("span",{parentName:"span",className:"vlist",style:{height:"0.2861em"}},(0,t.yg)("span",{parentName:"span"})))))),(0,t.yg)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2222em"}}),(0,t.yg)("span",{parentName:"span",className:"mbin"},"\u22c5"),(0,t.yg)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2222em"}})),(0,t.yg)("span",{parentName:"span",className:"base"},(0,t.yg)("span",{parentName:"span",className:"strut",style:{height:"1.1491em",verticalAlign:"-0.25em"}}),(0,t.yg)("span",{parentName:"span",className:"mord"},(0,t.yg)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.13889em"}},"W"),(0,t.yg)("span",{parentName:"span",className:"msupsub"},(0,t.yg)("span",{parentName:"span",className:"vlist-t"},(0,t.yg)("span",{parentName:"span",className:"vlist-r"},(0,t.yg)("span",{parentName:"span",className:"vlist",style:{height:"0.8991em"}},(0,t.yg)("span",{parentName:"span",style:{top:"-3.113em",marginRight:"0.05em"}},(0,t.yg)("span",{parentName:"span",className:"pstrut",style:{height:"2.7em"}}),(0,t.yg)("span",{parentName:"span",className:"sizing reset-size6 size3 mtight"},(0,t.yg)("span",{parentName:"span",className:"mord mtight"},(0,t.yg)("span",{parentName:"span",className:"mord mathnormal mtight",style:{marginRight:"0.03148em"}},"jk"))))))))),(0,t.yg)("span",{parentName:"span",className:"mclose"},")"),(0,t.yg)("span",{parentName:"span",className:"mspace allowbreak"}),(0,t.yg)("span",{parentName:"span",className:"mspace",style:{marginRight:"1em"}})),(0,t.yg)("span",{parentName:"span",className:"base"},(0,t.yg)("span",{parentName:"span",className:"strut",style:{height:"0.8889em",verticalAlign:"-0.1944em"}}),(0,t.yg)("span",{parentName:"span",className:"mord"},(0,t.yg)("span",{parentName:"span",className:"mord"},(0,t.yg)("span",{parentName:"span",className:"mord mathrm"},"mod"))),(0,t.yg)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.1667em"}}),(0,t.yg)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.1667em"}}),(0,t.yg)("span",{parentName:"span",className:"mord mathnormal"},"p")))))),(0,t.yg)("p",{parentName:"li"},"where ",(0,t.yg)("span",{parentName:"p",className:"math math-inline"},(0,t.yg)("span",{parentName:"span",className:"katex"},(0,t.yg)("span",{parentName:"span",className:"katex-mathml"},(0,t.yg)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,t.yg)("semantics",{parentName:"math"},(0,t.yg)("mrow",{parentName:"semantics"},(0,t.yg)("msub",{parentName:"mrow"},(0,t.yg)("mi",{parentName:"msub"},"X"),(0,t.yg)("mrow",{parentName:"msub"},(0,t.yg)("mi",{parentName:"mrow"},"k"),(0,t.yg)("mo",{parentName:"mrow",separator:"true"},","),(0,t.yg)("mi",{parentName:"mrow"},"r")))),(0,t.yg)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"X_{k,r}")))),(0,t.yg)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,t.yg)("span",{parentName:"span",className:"base"},(0,t.yg)("span",{parentName:"span",className:"strut",style:{height:"0.9694em",verticalAlign:"-0.2861em"}}),(0,t.yg)("span",{parentName:"span",className:"mord"},(0,t.yg)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.07847em"}},"X"),(0,t.yg)("span",{parentName:"span",className:"msupsub"},(0,t.yg)("span",{parentName:"span",className:"vlist-t vlist-t2"},(0,t.yg)("span",{parentName:"span",className:"vlist-r"},(0,t.yg)("span",{parentName:"span",className:"vlist",style:{height:"0.3361em"}},(0,t.yg)("span",{parentName:"span",style:{top:"-2.55em",marginLeft:"-0.0785em",marginRight:"0.05em"}},(0,t.yg)("span",{parentName:"span",className:"pstrut",style:{height:"2.7em"}}),(0,t.yg)("span",{parentName:"span",className:"sizing reset-size6 size3 mtight"},(0,t.yg)("span",{parentName:"span",className:"mord mtight"},(0,t.yg)("span",{parentName:"span",className:"mord mathnormal mtight",style:{marginRight:"0.03148em"}},"k"),(0,t.yg)("span",{parentName:"span",className:"mpunct mtight"},","),(0,t.yg)("span",{parentName:"span",className:"mord mathnormal mtight",style:{marginRight:"0.02778em"}},"r"))))),(0,t.yg)("span",{parentName:"span",className:"vlist-s"},"\u200b")),(0,t.yg)("span",{parentName:"span",className:"vlist-r"},(0,t.yg)("span",{parentName:"span",className:"vlist",style:{height:"0.2861em"}},(0,t.yg)("span",{parentName:"span"}))))))))))," is the output of the ",(0,t.yg)("span",{parentName:"p",className:"math math-inline"},(0,t.yg)("span",{parentName:"span",className:"katex"},(0,t.yg)("span",{parentName:"span",className:"katex-mathml"},(0,t.yg)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,t.yg)("semantics",{parentName:"math"},(0,t.yg)("mrow",{parentName:"semantics"},(0,t.yg)("mi",{parentName:"mrow"},"r"),(0,t.yg)("mi",{parentName:"mrow"},"a"),(0,t.yg)("mi",{parentName:"mrow"},"d"),(0,t.yg)("mi",{parentName:"mrow"},"i"),(0,t.yg)("mi",{parentName:"mrow"},"x"),(0,t.yg)("mo",{parentName:"mrow"},"\u2212"),(0,t.yg)("mi",{parentName:"mrow"},"r")),(0,t.yg)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"radix-r")))),(0,t.yg)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,t.yg)("span",{parentName:"span",className:"base"},(0,t.yg)("span",{parentName:"span",className:"strut",style:{height:"0.7778em",verticalAlign:"-0.0833em"}}),(0,t.yg)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.02778em"}},"r"),(0,t.yg)("span",{parentName:"span",className:"mord mathnormal"},"a"),(0,t.yg)("span",{parentName:"span",className:"mord mathnormal"},"d"),(0,t.yg)("span",{parentName:"span",className:"mord mathnormal"},"i"),(0,t.yg)("span",{parentName:"span",className:"mord mathnormal"},"x"),(0,t.yg)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2222em"}}),(0,t.yg)("span",{parentName:"span",className:"mbin"},"\u2212"),(0,t.yg)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2222em"}})),(0,t.yg)("span",{parentName:"span",className:"base"},(0,t.yg)("span",{parentName:"span",className:"strut",style:{height:"0.4306em"}}),(0,t.yg)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.02778em"}},"r")))))," butterfly operation for the ",(0,t.yg)("span",{parentName:"p",className:"math math-inline"},(0,t.yg)("span",{parentName:"span",className:"katex"},(0,t.yg)("span",{parentName:"span",className:"katex-mathml"},(0,t.yg)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,t.yg)("semantics",{parentName:"math"},(0,t.yg)("mrow",{parentName:"semantics"},(0,t.yg)("mi",{parentName:"mrow"},"k"),(0,t.yg)("mo",{parentName:"mrow"},"\u2212"),(0,t.yg)("mi",{parentName:"mrow"},"t"),(0,t.yg)("mi",{parentName:"mrow"},"h")),(0,t.yg)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"k-th")))),(0,t.yg)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,t.yg)("span",{parentName:"span",className:"base"},(0,t.yg)("span",{parentName:"span",className:"strut",style:{height:"0.7778em",verticalAlign:"-0.0833em"}}),(0,t.yg)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.03148em"}},"k"),(0,t.yg)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2222em"}}),(0,t.yg)("span",{parentName:"span",className:"mbin"},"\u2212"),(0,t.yg)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2222em"}})),(0,t.yg)("span",{parentName:"span",className:"base"},(0,t.yg)("span",{parentName:"span",className:"strut",style:{height:"0.6944em"}}),(0,t.yg)("span",{parentName:"span",className:"mord mathnormal"},"t"),(0,t.yg)("span",{parentName:"span",className:"mord mathnormal"},"h")))))," set of inputs, ",(0,t.yg)("span",{parentName:"p",className:"math math-inline"},(0,t.yg)("span",{parentName:"span",className:"katex"},(0,t.yg)("span",{parentName:"span",className:"katex-mathml"},(0,t.yg)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,t.yg)("semantics",{parentName:"math"},(0,t.yg)("mrow",{parentName:"semantics"},(0,t.yg)("msub",{parentName:"mrow"},(0,t.yg)("mi",{parentName:"msub"},"A"),(0,t.yg)("mrow",{parentName:"msub"},(0,t.yg)("mi",{parentName:"mrow"},"j"),(0,t.yg)("mo",{parentName:"mrow",separator:"true"},","),(0,t.yg)("mi",{parentName:"mrow"},"k")))),(0,t.yg)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"A_{j,k}")))),(0,t.yg)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,t.yg)("span",{parentName:"span",className:"base"},(0,t.yg)("span",{parentName:"span",className:"strut",style:{height:"0.9694em",verticalAlign:"-0.2861em"}}),(0,t.yg)("span",{parentName:"span",className:"mord"},(0,t.yg)("span",{parentName:"span",className:"mord mathnormal"},"A"),(0,t.yg)("span",{parentName:"span",className:"msupsub"},(0,t.yg)("span",{parentName:"span",className:"vlist-t vlist-t2"},(0,t.yg)("span",{parentName:"span",className:"vlist-r"},(0,t.yg)("span",{parentName:"span",className:"vlist",style:{height:"0.3361em"}},(0,t.yg)("span",{parentName:"span",style:{top:"-2.55em",marginLeft:"0em",marginRight:"0.05em"}},(0,t.yg)("span",{parentName:"span",className:"pstrut",style:{height:"2.7em"}}),(0,t.yg)("span",{parentName:"span",className:"sizing reset-size6 size3 mtight"},(0,t.yg)("span",{parentName:"span",className:"mord mtight"},(0,t.yg)("span",{parentName:"span",className:"mord mathnormal mtight",style:{marginRight:"0.05724em"}},"j"),(0,t.yg)("span",{parentName:"span",className:"mpunct mtight"},","),(0,t.yg)("span",{parentName:"span",className:"mord mathnormal mtight",style:{marginRight:"0.03148em"}},"k"))))),(0,t.yg)("span",{parentName:"span",className:"vlist-s"},"\u200b")),(0,t.yg)("span",{parentName:"span",className:"vlist-r"},(0,t.yg)("span",{parentName:"span",className:"vlist",style:{height:"0.2861em"}},(0,t.yg)("span",{parentName:"span"}))))))))))," represents the ",(0,t.yg)("span",{parentName:"p",className:"math math-inline"},(0,t.yg)("span",{parentName:"span",className:"katex"},(0,t.yg)("span",{parentName:"span",className:"katex-mathml"},(0,t.yg)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,t.yg)("semantics",{parentName:"math"},(0,t.yg)("mrow",{parentName:"semantics"},(0,t.yg)("mi",{parentName:"mrow"},"j"),(0,t.yg)("mo",{parentName:"mrow"},"\u2212"),(0,t.yg)("mi",{parentName:"mrow"},"t"),(0,t.yg)("mi",{parentName:"mrow"},"h")),(0,t.yg)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"j-th")))),(0,t.yg)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,t.yg)("span",{parentName:"span",className:"base"},(0,t.yg)("span",{parentName:"span",className:"strut",style:{height:"0.854em",verticalAlign:"-0.1944em"}}),(0,t.yg)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.05724em"}},"j"),(0,t.yg)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2222em"}}),(0,t.yg)("span",{parentName:"span",className:"mbin"},"\u2212"),(0,t.yg)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2222em"}})),(0,t.yg)("span",{parentName:"span",className:"base"},(0,t.yg)("span",{parentName:"span",className:"strut",style:{height:"0.6944em"}}),(0,t.yg)("span",{parentName:"span",className:"mord mathnormal"},"t"),(0,t.yg)("span",{parentName:"span",className:"mord mathnormal"},"h")))))," input element for the ",(0,t.yg)("span",{parentName:"p",className:"math math-inline"},(0,t.yg)("span",{parentName:"span",className:"katex"},(0,t.yg)("span",{parentName:"span",className:"katex-mathml"},(0,t.yg)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,t.yg)("semantics",{parentName:"math"},(0,t.yg)("mrow",{parentName:"semantics"},(0,t.yg)("mi",{parentName:"mrow"},"k"),(0,t.yg)("mo",{parentName:"mrow"},"\u2212"),(0,t.yg)("mi",{parentName:"mrow"},"t"),(0,t.yg)("mi",{parentName:"mrow"},"h")),(0,t.yg)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"k-th")))),(0,t.yg)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,t.yg)("span",{parentName:"span",className:"base"},(0,t.yg)("span",{parentName:"span",className:"strut",style:{height:"0.7778em",verticalAlign:"-0.0833em"}}),(0,t.yg)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.03148em"}},"k"),(0,t.yg)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2222em"}}),(0,t.yg)("span",{parentName:"span",className:"mbin"},"\u2212"),(0,t.yg)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2222em"}})),(0,t.yg)("span",{parentName:"span",className:"base"},(0,t.yg)("span",{parentName:"span",className:"strut",style:{height:"0.6944em"}}),(0,t.yg)("span",{parentName:"span",className:"mord mathnormal"},"t"),(0,t.yg)("span",{parentName:"span",className:"mord mathnormal"},"h")))))," operation, ",(0,t.yg)("span",{parentName:"p",className:"math math-inline"},(0,t.yg)("span",{parentName:"span",className:"katex"},(0,t.yg)("span",{parentName:"span",className:"katex-mathml"},(0,t.yg)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,t.yg)("semantics",{parentName:"math"},(0,t.yg)("mrow",{parentName:"semantics"},(0,t.yg)("mi",{parentName:"mrow"},"W")),(0,t.yg)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"W")))),(0,t.yg)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,t.yg)("span",{parentName:"span",className:"base"},(0,t.yg)("span",{parentName:"span",className:"strut",style:{height:"0.6833em"}}),(0,t.yg)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.13889em"}},"W")))))," is the twiddle factor, and ",(0,t.yg)("span",{parentName:"p",className:"math math-inline"},(0,t.yg)("span",{parentName:"span",className:"katex"},(0,t.yg)("span",{parentName:"span",className:"katex-mathml"},(0,t.yg)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,t.yg)("semantics",{parentName:"math"},(0,t.yg)("mrow",{parentName:"semantics"},(0,t.yg)("mi",{parentName:"mrow"},"p")),(0,t.yg)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"p")))),(0,t.yg)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,t.yg)("span",{parentName:"span",className:"base"},(0,t.yg)("span",{parentName:"span",className:"strut",style:{height:"0.625em",verticalAlign:"-0.1944em"}}),(0,t.yg)("span",{parentName:"span",className:"mord mathnormal"},"p")))))," is the prime modulus.")),(0,t.yg)("li",{parentName:"ol"},(0,t.yg)("p",{parentName:"li"},(0,t.yg)("strong",{parentName:"p"},"Recombination and Reordering:"),"\nAfter applying the appropriate butterfly operations across all decomposition levels, the Mixed Radix algorithm recombines the results into a single output sequence. Due to the varied sizes of the sub-transforms, a more complex reordering process may be required compared to Radix-2. This involves digit-reversal permutations to ensure that the final output sequence is correctly ordered."))),(0,t.yg)("h3",{id:"which-algorithm-should-i-choose-"},"Which algorithm should I choose ?"),(0,t.yg)("p",null,"Radix 2 is faster for small NTTs. A small NTT would be around logN = 16 and batch size 1. Its also more suited for inputs which are power of 2 (e.g., 256, 512, 1024). Radix 2 won't necessarily perform better for smaller ",(0,t.yg)("inlineCode",{parentName:"p"},"logn")," with larger batches."),(0,t.yg)("p",null,"Mixed radix on the other hand better for larger NTTs with larger input sizes which are not necessarily power of 2."),(0,t.yg)("p",null,"Performance really depends on logn size, batch size, ordering, inverse, coset, coeff-field and which GPU you are using."),(0,t.yg)("p",null,"For this reason we implemented our ",(0,t.yg)("a",{parentName:"p",href:"https://github.com/ingonyama-zk/icicle/blob/774250926c00ffe84548bc7dd97aea5227afed7e/icicle/appUtils/ntt/ntt.cu#L474"},"heuristic auto-selection")," which should choose the most efficient algorithm in most cases. "),(0,t.yg)("p",null,"We still recommend you benchmark for your specific use case if you think a different configuration would yield better results."))}y.isMDXComponent=!0},1873:(a,e,s)=>{s(6540)}}]);